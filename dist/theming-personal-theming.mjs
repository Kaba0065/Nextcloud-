/*! third party licenses: dist/vendor.LICENSE.txt */
import{bU as w,bG as Et,bO as L,F as kt,I as Ft,bD as O,bR as q,bK as jt,bJ as Bt,cR as wt,G as Tt,aM as Nt,a5 as Vt,ag as Ct,bg as ct,aJ as dt,bE as Y,bQ as R,aH as Z}from"./core-common.mjs";import{A as Rt,r as Ht}from"./chunks/AppOrderSelector-2hTZPhY0.mjs";import{M as qt}from"./chunks/index-D0tJKDfW.mjs";import{E as Ut,f as zt,l as Gt}from"./chunks/_setToString-D2g9rVjk.mjs";import{_ as Wt}from"./chunks/_baseEach-BGqCZ98m.mjs";import{a as $t,c as Kt}from"./chunks/_baseIteratee-BndskHKM.mjs";import{d as Qt}from"./chunks/index-Cf1NFlIs.mjs";import{a as Jt,b as Xt}from"./chunks/_isIterateeCall-cIIcpi4J.mjs";import{e as Yt}from"./chunks/_Set-Cq4kerQ7.mjs";import{r as Zt}from"./chunks/url-84ru6Jh_.mjs";import{r as te,X as ee,aC as re,n as X,aD as ne}from"./chunks/icons-BxSPavMS.mjs";import{v as tt}from"./chunks/toast-7xJhDYMn-BrG8uCqw.mjs";import"./chunks/index-Ca0QcE7e.mjs";import"./chunks/sortable.esm-CKUZvLoo.mjs";import"./chunks/preload-helper-3Yr03P9X.mjs";import"./chunks/isSymbol-D7eKlFoH.mjs";var H={},U={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getColorIndex=e.getColorDiffStatus=e.hexDiff=e.rgbDiff=e.deltaE94=e.rgbToCIELab=e.xyzToCIELab=e.rgbToXyz=e.hslToRgb=e.rgbToHsl=e.rgbToHex=e.hexToRgb=e.defer=e.RSHIFT=e.SIGBITS=e.DELTAE94_DIFF_STATUS=void 0,e.DELTAE94_DIFF_STATUS={NA:0,PERFECT:1,CLOSE:2,GOOD:10,SIMILAR:50},e.SIGBITS=5,e.RSHIFT=8-e.SIGBITS;function r(){var s,l,d=new Promise(function(g,v){s=g,l=v});return{resolve:s,reject:l,promise:d}}e.defer=r;function n(s){var l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return l===null?null:[l[1],l[2],l[3]].map(function(d){return parseInt(d,16)})}e.hexToRgb=n;function a(s,l,d){return"#"+((1<<24)+(s<<16)+(l<<8)+d).toString(16).slice(1,7)}e.rgbToHex=a;function o(s,l,d){s/=255,l/=255,d/=255;var g=Math.max(s,l,d),v=Math.min(s,l,d),y,k,C=(g+v)/2;if(g===v)y=k=0;else{var T=g-v;switch(k=C>.5?T/(2-g-v):T/(g+v),g){case s:y=(l-d)/T+(l<d?6:0);break;case l:y=(d-s)/T+2;break;case d:y=(s-l)/T+4;break}y/=6}return[y,k,C]}e.rgbToHsl=o;function i(s,l,d){var g,v,y;function k(x,M,I){return I<0&&(I+=1),I>1&&(I-=1),I<1/6?x+(M-x)*6*I:I<1/2?M:I<2/3?x+(M-x)*(2/3-I)*6:x}if(l===0)g=v=y=d;else{var C=d<.5?d*(1+l):d+l-d*l,T=2*d-C;g=k(T,C,s+1/3),v=k(T,C,s),y=k(T,C,s-1/3)}return[g*255,v*255,y*255]}e.hslToRgb=i;function u(s,l,d){s/=255,l/=255,d/=255,s=s>.04045?Math.pow((s+.005)/1.055,2.4):s/12.92,l=l>.04045?Math.pow((l+.005)/1.055,2.4):l/12.92,d=d>.04045?Math.pow((d+.005)/1.055,2.4):d/12.92,s*=100,l*=100,d*=100;var g=s*.4124+l*.3576+d*.1805,v=s*.2126+l*.7152+d*.0722,y=s*.0193+l*.1192+d*.9505;return[g,v,y]}e.rgbToXyz=u;function p(s,l,d){var g=95.047,v=100,y=108.883;s/=g,l/=v,d/=y,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116;var k=116*l-16,C=500*(s-l),T=200*(l-d);return[k,C,T]}e.xyzToCIELab=p;function f(s,l,d){var g=u(s,l,d),v=g[0],y=g[1],k=g[2];return p(v,y,k)}e.rgbToCIELab=f;function m(s,l){var d=1,g=1,v=1,y=s[0],k=s[1],C=s[2],T=l[0],x=l[1],M=l[2],I=y-T,j=k-x,z=C-M,B=Math.sqrt(k*k+C*C),G=Math.sqrt(x*x+M*M),A=T-y,P=G-B,S=Math.sqrt(I*I+j*j+z*z),N=Math.sqrt(S)>Math.sqrt(Math.abs(A))+Math.sqrt(Math.abs(P))?Math.sqrt(S*S-A*A-P*P):0,W=1+.045*B,$=1+.015*B;return A/=d,P/=g*W,N/=v*$,Math.sqrt(A*A+P*P+N*N)}e.deltaE94=m;function b(s,l){var d=f.apply(void 0,s),g=f.apply(void 0,l);return m(d,g)}e.rgbDiff=b;function _(s,l){var d=n(s),g=n(l);return b(d,g)}e.hexDiff=_;function c(s){return s<e.DELTAE94_DIFF_STATUS.NA?"N/A":s<=e.DELTAE94_DIFF_STATUS.PERFECT?"Perfect":s<=e.DELTAE94_DIFF_STATUS.CLOSE?"Close":s<=e.DELTAE94_DIFF_STATUS.GOOD?"Good":s<e.DELTAE94_DIFF_STATUS.SIMILAR?"Similar":"Wrong"}e.getColorDiffStatus=c;function h(s,l,d){return(s<<2*e.SIGBITS)+(l<<e.SIGBITS)+d}e.getColorIndex=h})(U);var ae=Wt;function oe(e,r){var n=[];return ae(e,function(a,o,i){r(a,o,i)&&n.push(a)}),n}var ie=oe,se=Ut,ue=ie,le=$t,ce=zt;function de(e,r){var n=ce(e)?se:ue;return n(e,le(r))}var he=de;Object.defineProperty(H,"__esModule",{value:!0}),H.Swatch=void 0;var ht=U,pe=he,ge=function(){function e(r,n){this._rgb=r,this._population=n}return e.applyFilter=function(r,n){return typeof n=="function"?pe(r,function(a){var o=a.r,i=a.g,u=a.b;return n(o,i,u,255)}):r},Object.defineProperty(e.prototype,"r",{get:function(){return this._rgb[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._rgb[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._rgb[2]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this._rgb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){if(!this._hsl){var r=this._rgb,n=r[0],a=r[1],o=r[2];this._hsl=ht.rgbToHsl(n,a,o)}return this._hsl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hex",{get:function(){if(!this._hex){var r=this._rgb,n=r[0],a=r[1],o=r[2];this._hex=ht.rgbToHex(n,a,o)}return this._hex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"population",{get:function(){return this._population},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{rgb:this.rgb,population:this.population}},e.prototype.getRgb=function(){return this._rgb},e.prototype.getHsl=function(){return this.hsl},e.prototype.getPopulation=function(){return this._population},e.prototype.getHex=function(){return this.hex},e.prototype.getYiq=function(){if(!this._yiq){var r=this._rgb;this._yiq=(r[0]*299+r[1]*587+r[2]*114)/1e3}return this._yiq},Object.defineProperty(e.prototype,"titleTextColor",{get:function(){return this._titleTextColor||(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyTextColor",{get:function(){return this._bodyTextColor||(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor},enumerable:!1,configurable:!0}),e.prototype.getTitleTextColor=function(){return this.titleTextColor},e.prototype.getBodyTextColor=function(){return this.bodyTextColor},e}();H.Swatch=ge;var K={},Q={},pt;function fe(){if(pt)return Q;pt=1;var e=w&&w.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Q,"__esModule",{value:!0});var r=e(Lt()),n=Kt,a=function(){function o(i,u){u===void 0&&(u={}),this._src=i,this._opts=u,this._opts.filters=n(r.default.DefaultOpts.filters)}return o.prototype.maxColorCount=function(i){return this._opts.colorCount=i,this},o.prototype.maxDimension=function(i){return this._opts.maxDimension=i,this},o.prototype.addFilter=function(i){return this._opts.filters.push(i),this},o.prototype.removeFilter=function(i){var u=this._opts.filters.indexOf(i);return u>0&&this._opts.filters.splice(u),this},o.prototype.clearFilters=function(){return this._opts.filters=[],this},o.prototype.quality=function(i){return this._opts.quality=i,this},o.prototype.useImageClass=function(i){return this._opts.ImageClass=i,this},o.prototype.useGenerator=function(i){return this._opts.generator=i,this},o.prototype.useQuantizer=function(i){return this._opts.quantizer=i,this},o.prototype.build=function(){return new r.default(this._src,this._opts)},o.prototype.getPalette=function(i){return this.build().getPalette(i)},o.prototype.getSwatches=function(i){return this.build().getPalette(i)},o}();return Q.default=a,Q}var St={},et={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});var D=U,me=function(){function e(r,n,a,o,i,u,p){this._volume=-1,this._count=-1,this.dimension={r1:r,r2:n,g1:a,g2:o,b1:i,b2:u},this.hist=p}return e.build=function(r,n){var a=1<<3*D.SIGBITS,o=new Uint32Array(a),i,u,p,f,m,b,_,c,h,s;i=p=m=0,u=f=b=Number.MAX_VALUE;for(var l=r.length/4,d=0;d<l;){var g=d*4;if(d++,_=r[g+0],c=r[g+1],h=r[g+2],s=r[g+3],s!==0){_=_>>D.RSHIFT,c=c>>D.RSHIFT,h=h>>D.RSHIFT;var v=D.getColorIndex(_,c,h);o[v]+=1,_>i&&(i=_),_<u&&(u=_),c>p&&(p=c),c<f&&(f=c),h>m&&(m=h),h<b&&(b=h)}}return new e(u,i,f,p,b,m,o)},e.prototype.invalidate=function(){this._volume=this._count=-1,this._avg=null},e.prototype.volume=function(){if(this._volume<0){var r=this.dimension,n=r.r1,a=r.r2,o=r.g1,i=r.g2,u=r.b1,p=r.b2;this._volume=(a-n+1)*(i-o+1)*(p-u+1)}return this._volume},e.prototype.count=function(){if(this._count<0){for(var r=this.hist,n=this.dimension,a=n.r1,o=n.r2,i=n.g1,u=n.g2,p=n.b1,f=n.b2,m=0,b=a;b<=o;b++)for(var _=i;_<=u;_++)for(var c=p;c<=f;c++){var h=D.getColorIndex(b,_,c);m+=r[h]}this._count=m}return this._count},e.prototype.clone=function(){var r=this.hist,n=this.dimension,a=n.r1,o=n.r2,i=n.g1,u=n.g2,p=n.b1,f=n.b2;return new e(a,o,i,u,p,f,r)},e.prototype.avg=function(){if(!this._avg){var r=this.hist,n=this.dimension,a=n.r1,o=n.r2,i=n.g1,u=n.g2,p=n.b1,f=n.b2,m=0,b=1<<8-D.SIGBITS,_=void 0,c=void 0,h=void 0;_=c=h=0;for(var s=a;s<=o;s++)for(var l=i;l<=u;l++)for(var d=p;d<=f;d++){var g=D.getColorIndex(s,l,d),v=r[g];m+=v,_+=v*(s+.5)*b,c+=v*(l+.5)*b,h+=v*(d+.5)*b}m?this._avg=[~~(_/m),~~(c/m),~~(h/m)]:this._avg=[~~(b*(a+o+1)/2),~~(b*(i+u+1)/2),~~(b*(p+f+1)/2)]}return this._avg},e.prototype.contains=function(r){var n=r[0],a=r[1],o=r[2],i=this.dimension,u=i.r1,p=i.r2,f=i.g1,m=i.g2,b=i.b1,_=i.b2;return n>>=D.RSHIFT,a>>=D.RSHIFT,o>>=D.RSHIFT,n>=u&&n<=p&&a>=f&&a<=m&&o>=b&&o<=_},e.prototype.split=function(){var r=this.hist,n=this.dimension,a=n.r1,o=n.r2,i=n.g1,u=n.g2,p=n.b1,f=n.b2,m=this.count();if(!m)return[];if(m===1)return[this.clone()];var b=o-a+1,_=u-i+1,c=f-p+1,h=Math.max(b,_,c),s=null,l,d;l=d=0;var g=null;if(h===b){g="r",s=new Uint32Array(o+1);for(var v=a;v<=o;v++){l=0;for(var y=i;y<=u;y++)for(var k=p;k<=f;k++){var C=D.getColorIndex(v,y,k);l+=r[C]}d+=l,s[v]=d}}else if(h===_){g="g",s=new Uint32Array(u+1);for(var y=i;y<=u;y++){l=0;for(var v=a;v<=o;v++)for(var k=p;k<=f;k++){var C=D.getColorIndex(v,y,k);l+=r[C]}d+=l,s[y]=d}}else{g="b",s=new Uint32Array(f+1);for(var k=p;k<=f;k++){l=0;for(var v=a;v<=o;v++)for(var y=i;y<=u;y++){var C=D.getColorIndex(v,y,k);l+=r[C]}d+=l,s[k]=d}}for(var T=-1,x=new Uint32Array(s.length),M=0;M<s.length;M++){var I=s[M];T<0&&I>d/2&&(T=M),x[M]=d-I}var j=this;function z(B){var G=B+"1",A=B+"2",P=j.dimension[G],S=j.dimension[A],N=j.clone(),W=j.clone(),$=T-P,ut=S-T;for($<=ut?(S=Math.min(S-1,~~(T+ut/2)),S=Math.max(0,S)):(S=Math.max(P,~~(T-1-$/2)),S=Math.min(j.dimension[A],S));!s[S];)S++;for(var lt=x[S];!lt&&s[S-1];)lt=x[--S];return N.dimension[A]=S,W.dimension[G]=S+1,[N,W]}return z(g)},e}();ot.default=me;var it={};Object.defineProperty(it,"__esModule",{value:!0});var be=function(){function e(r){this._comparator=r,this.contents=[],this._sorted=!1}return e.prototype._sort=function(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)},e.prototype.push=function(r){this.contents.push(r),this._sorted=!1},e.prototype.peek=function(r){return this._sort(),r=typeof r=="number"?r:this.contents.length-1,this.contents[r]},e.prototype.pop=function(){return this._sort(),this.contents.pop()},e.prototype.size=function(){return this.contents.length},e.prototype.map=function(r){return this._sort(),this.contents.map(r)},e}();it.default=be;var It=w&&w.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(et,"__esModule",{value:!0});var ve=H,_e=It(ot),gt=It(it),ye=.75;function ft(e,r){for(var n=e.size();e.size()<r;){var a=e.pop();if(a&&a.count()>0){var o=a.split(),i=o[0],u=o[1];if(e.push(i),u&&u.count()>0&&e.push(u),e.size()===n)break;n=e.size()}else break}}var ke=function(e,r){if(e.length===0||r.colorCount<2||r.colorCount>256)throw new Error("Wrong MMCQ parameters");var n=_e.default.build(e),a=n.hist;Object.keys(a).length;var o=new gt.default(function(u,p){return u.count()-p.count()});o.push(n),ft(o,ye*r.colorCount);var i=new gt.default(function(u,p){return u.count()*u.volume()-p.count()*p.volume()});return i.contents=o.contents,ft(i,r.colorCount-i.size()),we(i)};function we(e){for(var r=[];e.size();){var n=e.pop(),a=n.avg();a[0],a[1],a[2],r.push(new ve.Swatch(a,n.count()))}return r}et.default=ke,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WebWorker=void 0;var r=et;Object.defineProperty(e,"MMCQ",{enumerable:!0,get:function(){return r.default}}),e.WebWorker=null}(St);var Dt={},rt={},Te=Jt,Ce=Yt,Se=Xt,Ie=Gt,xt=Object.prototype,De=xt.hasOwnProperty,xe=Te(function(e,r){e=Object(e);var n=-1,a=r.length,o=a>2?r[2]:void 0;for(o&&Se(r[0],r[1],o)&&(a=1);++n<a;)for(var i=r[n],u=Ie(i),p=-1,f=u.length;++p<f;){var m=u[p],b=e[m];(b===void 0||Ce(b,xt[m])&&!De.call(e,m))&&(e[m]=i[m])}return e}),Mt=xe;Object.defineProperty(rt,"__esModule",{value:!0});var E=H,F=U,Me=Mt,Oe={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function Le(e){var r=0;return e.forEach(function(n){r=Math.max(r,n.getPopulation())}),r}function Ae(e,r){return e.Vibrant===r||e.DarkVibrant===r||e.LightVibrant===r||e.Muted===r||e.DarkMuted===r||e.LightMuted===r}function Pe(e,r,n,a,o,i,u){function p(){for(var m=[],b=0;b<arguments.length;b++)m[b]=arguments[b];for(var _=0,c=0,h=0;h<m.length;h+=2){var s=m[h],l=m[h+1];_+=s*l,c+=l}return _/c}function f(m,b){return 1-Math.abs(m-b)}return p(f(e,r),u.weightSaturation,f(n,a),u.weightLuma,o/i,u.weightPopulation)}function V(e,r,n,a,o,i,u,p,f,m){var b=null,_=0;return r.forEach(function(c){var h=c.getHsl(),s=h[1],l=h[2];if(s>=p&&s<=f&&l>=o&&l<=i&&!Ae(e,c)){var d=Pe(s,u,l,a,c.getPopulation(),n,m);(b===null||d>_)&&(b=c,_=d)}}),b}function Ee(e,r,n){var a={};return a.Vibrant=V(a,e,r,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),a.LightVibrant=V(a,e,r,n.targetLightLuma,n.minLightLuma,1,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),a.DarkVibrant=V(a,e,r,n.targetDarkLuma,0,n.maxDarkLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),a.Muted=V(a,e,r,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),a.LightMuted=V(a,e,r,n.targetLightLuma,n.minLightLuma,1,n.targetMutesSaturation,0,n.maxMutesSaturation,n),a.DarkMuted=V(a,e,r,n.targetDarkLuma,0,n.maxDarkLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),a}function Fe(e,r,n){if(e.Vibrant===null&&e.DarkVibrant===null&&e.LightVibrant===null){if(e.DarkVibrant===null&&e.DarkMuted!==null){var a=e.DarkMuted.getHsl(),o=a[0],i=a[1],u=a[2];u=n.targetDarkLuma,e.DarkVibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.LightVibrant===null&&e.LightMuted!==null){var p=e.LightMuted.getHsl(),o=p[0],i=p[1],u=p[2];u=n.targetDarkLuma,e.DarkVibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}}if(e.Vibrant===null&&e.DarkVibrant!==null){var f=e.DarkVibrant.getHsl(),o=f[0],i=f[1],u=f[2];u=n.targetNormalLuma,e.Vibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}else if(e.Vibrant===null&&e.LightVibrant!==null){var m=e.LightVibrant.getHsl(),o=m[0],i=m[1],u=m[2];u=n.targetNormalLuma,e.Vibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.DarkVibrant===null&&e.Vibrant!==null){var b=e.Vibrant.getHsl(),o=b[0],i=b[1],u=b[2];u=n.targetDarkLuma,e.DarkVibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.LightVibrant===null&&e.Vibrant!==null){var _=e.Vibrant.getHsl(),o=_[0],i=_[1],u=_[2];u=n.targetLightLuma,e.LightVibrant=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.Muted===null&&e.Vibrant!==null){var c=e.Vibrant.getHsl(),o=c[0],i=c[1],u=c[2];u=n.targetMutesSaturation,e.Muted=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.DarkMuted===null&&e.DarkVibrant!==null){var h=e.DarkVibrant.getHsl(),o=h[0],i=h[1],u=h[2];u=n.targetMutesSaturation,e.DarkMuted=new E.Swatch(F.hslToRgb(o,i,u),0)}if(e.LightMuted===null&&e.LightVibrant!==null){var s=e.LightVibrant.getHsl(),o=s[0],i=s[1],u=s[2];u=n.targetMutesSaturation,e.LightMuted=new E.Swatch(F.hslToRgb(o,i,u),0)}}var je=function(e,r){r=Me({},r,Oe);var n=Le(e),a=Ee(e,n,r);return Fe(a,n,r),a};rt.default=je,function(e){Object.defineProperty(e,"__esModule",{value:!0});var r=rt;Object.defineProperty(e,"Default",{enumerable:!0,get:function(){return r.default}})}(Dt);var Ot={},nt={};Object.defineProperty(nt,"__esModule",{value:!0});function Be(e,r,n,a){return a>=125&&!(e>250&&r>250&&n>250)}nt.default=Be,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.combineFilters=void 0;var r=nt;Object.defineProperty(e,"Default",{enumerable:!0,get:function(){return r.default}});function n(a){return!Array.isArray(a)||a.length===0?null:function(o,i,u,p){if(p===0)return!1;for(var f=0;f<a.length;f++)if(!a[f](o,i,u,p))return!1;return!0}}e.combineFilters=n}(Ot);var mt;function Lt(){if(mt)return K;mt=1;var e=w&&w.__createBinding||(Object.create?function(c,h,s,l){l===void 0&&(l=s),Object.defineProperty(c,l,{enumerable:!0,get:function(){return h[s]}})}:function(c,h,s,l){l===void 0&&(l=s),c[l]=h[s]}),r=w&&w.__setModuleDefault||(Object.create?function(c,h){Object.defineProperty(c,"default",{enumerable:!0,value:h})}:function(c,h){c.default=h}),n=w&&w.__importStar||function(c){if(c&&c.__esModule)return c;var h={};if(c!=null)for(var s in c)s!=="default"&&Object.hasOwnProperty.call(c,s)&&e(h,c,s);return r(h,c),h},a=w&&w.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(K,"__esModule",{value:!0});var o=H,i=a(fe()),u=n(U),p=n(St),f=n(Dt),m=n(Ot),b=Mt,_=function(){function c(h,s){this._src=h,this.opts=b({},s,c.DefaultOpts),this.opts.combinedFilter=m.combineFilters(this.opts.filters)}return c.from=function(h){return new i.default(h)},c.prototype._process=function(h,s){var l=s.quantizer,d=s.generator;return h.scaleDown(s),h.applyFilter(s.combinedFilter).then(function(g){return l(g.data,s)}).then(function(g){return o.Swatch.applyFilter(g,s.combinedFilter)}).then(function(g){return Promise.resolve(d(g))})},c.prototype.palette=function(){return this.swatches()},c.prototype.swatches=function(){return this._palette},c.prototype.getPalette=function(h){var s=this,l=new this.opts.ImageClass,d=l.load(this._src).then(function(g){return s._process(g,s.opts)}).then(function(g){return s._palette=g,l.remove(),g},function(g){throw l.remove(),g});return h&&d.then(function(g){return h(null,g)},function(g){return h(g)}),d},c.Builder=i.default,c.Quantizer=p,c.Generator=f,c.Filter=m,c.Util=u,c.Swatch=o.Swatch,c.DefaultOpts={colorCount:64,quality:5,generator:f.Default,ImageClass:null,quantizer:p.MMCQ,filters:[m.Default]},c}();return K.default=_,K}var st={},J={};Object.defineProperty(J,"__esModule",{value:!0}),J.ImageBase=void 0;var Ne=function(){function e(){}return e.prototype.scaleDown=function(r){var n=this.getWidth(),a=this.getHeight(),o=1;if(r.maxDimension>0){var i=Math.max(n,a);i>r.maxDimension&&(o=r.maxDimension/i)}else o=1/r.quality;o<1&&this.resize(n*o,a*o,o)},e.prototype.applyFilter=function(r){var n=this.getImageData();if(typeof r=="function")for(var a=n.data,o=a.length/4,i=void 0,u=void 0,p=void 0,f=void 0,m=void 0,b=0;b<o;b++)i=b*4,u=a[i+0],p=a[i+1],f=a[i+2],m=a[i+3],r(u,p,f,m)||(a[i+3]=0);return Promise.resolve(n)},e}();J.ImageBase=Ne;var Ve=w&&w.__extends||function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var i in o)o.hasOwnProperty(i)&&(a[i]=o[i])},e(r,n)};return function(r,n){e(r,n);function a(){this.constructor=r}r.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}}(),Re=w&&w.__createBinding||(Object.create?function(e,r,n,a){a===void 0&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,a){a===void 0&&(a=n),e[a]=r[n]}),He=w&&w.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),qe=w&&w.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var n in e)n!=="default"&&Object.hasOwnProperty.call(e,n)&&Re(r,e,n);return He(r,e),r};Object.defineProperty(st,"__esModule",{value:!0});var Ue=J,at=qe(Zt);function ze(e){var r=at.parse(e);return r.protocol===null&&r.host===null&&r.port===null}function Ge(e,r){var n=at.parse(e),a=at.parse(r);return n.protocol===a.protocol&&n.hostname===a.hostname&&n.port===a.port}var We=function(e){Ve(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype._initCanvas=function(){var n=this.image,a=this._canvas=document.createElement("canvas"),o=this._context=a.getContext("2d");a.className="vibrant-canvas",a.style.display="none",this._width=a.width=n.width,this._height=a.height=n.height,o.drawImage(n,0,0),document.body.appendChild(a)},r.prototype.load=function(n){var a=this,o=null,i=null;if(typeof n=="string")o=document.createElement("img"),!ze(n)&&!Ge(window.location.href,n)&&(o.crossOrigin="anonymous"),i=o.src=n;else if(n instanceof HTMLImageElement)o=n,i=n.src;else return Promise.reject(new Error("Cannot load buffer as an image in browser"));return this.image=o,new Promise(function(u,p){var f=function(){a._initCanvas(),u(a)};o.complete?f():(o.onload=f,o.onerror=function(m){return p(new Error("Fail to load image: "+i))})})},r.prototype.clear=function(){this._context.clearRect(0,0,this._width,this._height)},r.prototype.update=function(n){this._context.putImageData(n,0,0)},r.prototype.getWidth=function(){return this._width},r.prototype.getHeight=function(){return this._height},r.prototype.resize=function(n,a,o){var i=this,u=i._canvas,p=i._context,f=i.image;this._width=u.width=n,this._height=u.height=a,p.scale(o,o),p.drawImage(f,0,0)},r.prototype.getPixelCount=function(){return this._width*this._height},r.prototype.getImageData=function(){return this._context.getImageData(0,0,this._width,this._height)},r.prototype.remove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},r}(Ue.ImageBase);st.default=We;var At=w&&w.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Pt=At(Lt()),$e=At(st);Pt.default.DefaultOpts.ImageClass=$e.default;var Ke=Pt.default;const Qe=Et(Ke),Je=L("theming","backgroundImage"),bt=L("theming","shippedBackgrounds"),vt=L("theming","themingDefaultBackground"),Xe=L("theming","defaultShippedBackground"),_t=e=>wt("theming","","img/background/")+e,Ye={name:"BackgroundSettings",components:{Check:te,Close:ee,ImageEdit:re,NcButton:kt,NcColorPicker:Ft},data(){return{loading:!1,Theming:L("theming","data",{}),backgroundImage:Je}},computed:{shippedBackgrounds(){return Object.keys(bt).map(e=>({name:e,url:_t(e),preview:_t("preview/"+e),details:bt[e]})).filter(e=>!this.isGlobalBackgroundDeleted&&!this.isGlobalBackgroundDefault?e.name!==Xe:!0)},isGlobalBackgroundDefault(){return!!vt},isGlobalBackgroundDeleted(){return vt==="backgroundColor"},isBackgroundDisabled(){return this.backgroundImage==="disabled"||!this.backgroundImage}},methods:{invertTextColor(e){return this.calculateLuma(e)>.6},calculateLuma(e){const[r,n,a]=this.hexToRGB(e);return(.2126*r+.7152*n+.0722*a)/255},hexToRGB(e){const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:null},async update(e){this.backgroundImage=e.backgroundImage,this.Theming.color=e.backgroundColor,this.$emit("update:background"),this.loading=!1},async setDefault(){this.loading="default";const e=await O.post(q("/apps/theming/background/default"));this.update(e.data)},async setShipped(e){this.loading=e;const r=await O.post(q("/apps/theming/background/shipped"),{value:e});this.update(r.data)},async setFile(e,r=null){this.loading="custom";const n=await O.post(q("/apps/theming/background/custom"),{value:e,color:r});this.update(n.data)},async removeBackground(){this.loading="remove";const e=await O.delete(q("/apps/theming/background/custom"));this.update(e.data)},async pickColor(e){var a,o,i;this.loading="color";const r=((o=(a=e==null?void 0:e.target)==null?void 0:a.dataset)==null?void 0:o.color)||((i=this.Theming)==null?void 0:i.color)||"#0082c9",n=await O.post(q("/apps/theming/background/color"),{color:r});this.update(n.data)},debouncePickColor:Qt(function(...e){this.pickColor(...e)},200),pickFile(){qt(t("theming","Select a background from your files")).allowDirectories(!1).setMimeTypeFilter(["image/png","image/gif","image/jpeg","image/svg+xml","image/svg"]).setMultiSelect(!1).addButton({id:"select",label:t("theming","Select background"),callback:e=>{var r;this.applyFile((r=e[0])==null?void 0:r.path)},type:"primary"}).build().pick()},async applyFile(e){var a;if(!e||typeof e!="string"||e.trim().length===0||e==="/"){console.error("No valid background have been selected",{path:e}),tt(t("theming","No background has been selected"));return}this.loading="custom";let r=null,n=null;try{const o=jt("dav/files/"+Bt().uid+e);r=await O.get(o,{responseType:"blob"});const i=URL.createObjectURL(r.data),u=await this.getColorPaletteFromBlob(i);n=(a=u==null?void 0:u.DarkVibrant)==null?void 0:a.hex,this.setFile(e,n),console.debug("Extracted colour",n,"from custom image",e,u)}catch(o){this.setFile(e),console.error("Unable to extract colour from custom image",{error:o,path:e,response:r,color:n})}},getColorPaletteFromBlob(e){return new Promise((r,n)=>{new Qe(e).getPalette((a,o)=>{a&&n(a),r(o)})})}}};var Ze=function(){var e=this,r=e._self._c;return r("div",{staticClass:"background-selector",attrs:{"data-user-theming-background-settings":""}},[r("button",{class:{"icon-loading":e.loading==="custom","background background__filepicker":!0,"background--active":e.backgroundImage==="custom"},attrs:{"aria-pressed":e.backgroundImage==="custom","data-color-bright":e.invertTextColor(e.Theming.color),"data-user-theming-background-custom":"",tabindex:"0"},on:{click:e.pickFile}},[e._v(" "+e._s(e.t("theming","Custom background"))+" "),e.backgroundImage!=="custom"?r("ImageEdit",{attrs:{size:26}}):e._e(),r("Check",{attrs:{size:44}})],1),r("button",{class:{"icon-loading":e.loading==="default","background background__default":!0,"background--active":e.backgroundImage==="default"},style:{"--border-color":e.Theming.defaultColor},attrs:{"aria-pressed":e.backgroundImage==="default","data-color-bright":e.invertTextColor(e.Theming.defaultColor),"data-user-theming-background-default":"",tabindex:"0"},on:{click:e.setDefault}},[e._v(" "+e._s(e.t("theming","Default background"))+" "),r("Check",{attrs:{size:44}})],1),r("div",{staticClass:"background-color",attrs:{"data-user-theming-background-color":""}},[r("NcColorPicker",{on:{input:e.debouncePickColor},model:{value:e.Theming.color,callback:function(n){e.$set(e.Theming,"color",n)},expression:"Theming.color"}},[r("NcButton",{attrs:{type:"ternary"}},[e._v(" "+e._s(e.t("theming","Change color"))+" ")])],1)],1),r("button",{class:{"background background__delete":!0,"background--active":e.isBackgroundDisabled},attrs:{"aria-pressed":e.isBackgroundDisabled,"data-user-theming-background-clear":"",tabindex:"0"},on:{click:e.removeBackground}},[e._v(" "+e._s(e.t("theming","No background"))+" "),e.isBackgroundDisabled?e._e():r("Close",{attrs:{size:32}}),r("Check",{attrs:{size:44}})],1),e._l(e.shippedBackgrounds,function(n){return r("button",{key:n.name,class:{"background background__shipped":!0,"icon-loading":e.loading===n.name,"background--active":e.backgroundImage===n.name},style:{backgroundImage:"url("+n.preview+")","--border-color":n.details.primary_color},attrs:{title:n.details.attribution,"aria-label":n.details.description,"aria-pressed":e.backgroundImage===n.name,"data-color-bright":n.details.theming==="dark","data-user-theming-background-shipped":n.name,tabindex:"0"},on:{click:function(a){return e.setShipped(n.name)}}},[r("Check",{attrs:{size:44}})],1)})],2)},tr=[],er=X(Ye,Ze,tr,!1,null,"6341317c",null,null);const rr=er.exports,nr={name:"ItemPreview",components:{NcCheckboxRadioSwitch:Tt},props:{enforced:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},theme:{type:Object,required:!0},type:{type:String,default:""},unique:{type:Boolean,default:!1}},computed:{switchType(){return this.unique?"switch":"radio"},name(){return this.unique?null:this.type},img(){return wt("theming","img",this.theme.id+".jpg")},checked:{get(){return this.selected},set(e){if(console.debug("Changed theme",this.theme.id,e),!this.unique){this.$emit("change",{enabled:!0,id:this.theme.id});return}this.$emit("change",{enabled:e===!0,id:this.theme.id})}}},methods:{onToggle(){if(this.switchType==="radio"){this.checked=!0;return}this.checked=!this.checked}}};var ar=function(){var e=this,r=e._self._c;return r("div",{staticClass:"theming__preview",class:"theming__preview--"+e.theme.id},[r("div",{staticClass:"theming__preview-image",style:{backgroundImage:"url("+e.img+")"},on:{click:e.onToggle}}),r("div",{staticClass:"theming__preview-description"},[r("h3",[e._v(e._s(e.theme.title))]),r("p",{staticClass:"theming__preview-explanation"},[e._v(e._s(e.theme.description))]),e.enforced?r("span",{staticClass:"theming__preview-warning",attrs:{role:"note"}},[e._v(" "+e._s(e.t("theming","Theme selection is enforced"))+" ")]):e._e(),r("NcCheckboxRadioSwitch",{staticClass:"theming__preview-toggle",attrs:{checked:e.checked,disabled:e.enforced,name:e.name,type:e.switchType},on:{"update:checked":function(n){e.checked=n}}},[e._v(" "+e._s(e.theme.enableLabel)+" ")])],1)])},or=[],ir=X(nr,ar,or,!1,null,"fecfd930",null,null);const sr=ir.exports,ur=Nt({name:"UserAppMenuSection",components:{AppOrderSelector:Rt,IconUndo:ne,NcButton:kt,NcNoteCard:Vt,NcSettingsSection:Ct},setup(){const{userAppOrder:e,enforcedDefaultApp:r}=L("theming","navigationBar"),n=Object.values(L("core","apps")).filter(({type:c})=>c==="link").map(c=>({...c,label:c.name,default:c.default&&c.app===r})),a=ct(!Array.isArray(e)||Object.values(e).length>0),o=dt(()=>n.some(({id:c},h)=>c!==f.value[h].id)),i="theming-apporder-changed-infocard",u="theming-apporder-changed-infocard",p=dt(()=>(o.value?"".concat(i," "):"")+(r?u:"")),f=ct([...n]),m=c=>{const h={};c.forEach(({app:s,id:l},d)=>{h[l]={order:d,app:s}}),_("apporder",h).then(()=>{f.value=c,a.value=!0}).catch(s=>{console.warn("Could not set the app order",s),tt(Y("theming","Could not set the app order"))})},b=async()=>{try{await _("apporder",[]),a.value=!1;const{data:c}=await O.get(R("/core/navigation/apps"),{headers:{"OCS-APIRequest":"true"}});f.value=c.ocs.data.map(h=>({...h,label:h.name,default:h.default&&h.app===r}))}catch(c){console.warn(c),tt(Y("theming","Could not reset the app order"))}},_=async(c,h)=>{const s=R("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"core",configKey:c});return await O.post(s,{configValue:JSON.stringify(h)})};return{appOrder:f,updateAppOrder:m,resetAppOrder:b,enforcedDefaultApp:r,hasAppOrderChanged:o,hasCustomAppOrder:a,ariaDetailsAppOrder:p,elementIdAppOrderChanged:i,elementIdEnforcedDefaultApp:u,t:Y}}});var lr=function(){var e=this,r=e._self._c;return e._self._setupProxy,r("NcSettingsSection",{attrs:{name:e.t("theming","Navigation bar settings")}},[r("p",[e._v(" "+e._s(e.t("theming","You can configure the app order used for the navigation bar. The first entry will be the default app, opened after login or when clicking on the logo."))+" ")]),e.enforcedDefaultApp?r("NcNoteCard",{attrs:{id:e.elementIdEnforcedDefaultApp,type:"info"}},[e._v(" "+e._s(e.t("theming","The default app can not be changed because it was configured by the administrator."))+" ")]):e._e(),e.hasAppOrderChanged?r("NcNoteCard",{attrs:{id:e.elementIdAppOrderChanged,type:"info"}},[e._v(" "+e._s(e.t("theming","The app order was changed, to see it in action you have to reload the page."))+" ")]):e._e(),r("AppOrderSelector",{staticClass:"user-app-menu-order",attrs:{"aria-details":e.ariaDetailsAppOrder,value:e.appOrder},on:{"update:value":e.updateAppOrder}}),r("NcButton",{attrs:{"data-test-id":"btn-apporder-reset",disabled:!e.hasCustomAppOrder,type:"tertiary"},on:{click:e.resetAppOrder},scopedSlots:e._u([{key:"icon",fn:function(){return[r("IconUndo",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("theming","Reset default app order"))+" ")])],1)},cr=[],dr=X(ur,lr,cr,!1,null,"be01f40d",null,null);const hr=dr.exports,pr=L("theming","themes",[]),gr=L("theming","enforceTheme",""),fr=L("theming","shortcutsDisabled",!1),mr=L("theming","isUserThemingDisabled"),br={name:"UserThemes",components:{ItemPreview:sr,NcCheckboxRadioSwitch:Tt,NcSettingsSection:Ct,BackgroundSettings:rr,UserAppMenuSection:hr},data(){return{availableThemes:pr,enforceTheme:gr,shortcutsDisabled:fr,isUserThemingDisabled:mr}},computed:{themes(){return this.availableThemes.filter(e=>e.type===1)},fonts(){return this.availableThemes.filter(e=>e.type===2)},selectedTheme(){return this.themes.find(e=>e.enabled===!0)||this.themes[0]},description(){return t("theming","Universal access is very important to us. We follow web standards and check to make everything usable also without mouse, and assistive software such as screenreaders. We aim to be compliant with the {guidelines}Web Content Accessibility Guidelines{linkend} 2.1 on AA level, with the high contrast theme even on AAA level.").replace("{guidelines}",this.guidelinesLink).replace("{linkend}","</a>")},guidelinesLink(){return'<a target="_blank" href="https://www.w3.org/WAI/standards-guidelines/wcag/" rel="noreferrer nofollow">'},descriptionDetail(){return t("theming","If you find any issues, do not hesitate to report them on {issuetracker}our issue tracker{linkend}. And if you want to get involved, come join {designteam}our design team{linkend}!").replace("{issuetracker}",this.issuetrackerLink).replace("{designteam}",this.designteamLink).replace(/\{linkend\}/g,"</a>")},issuetrackerLink(){return'<a target="_blank" href="https://github.com/nextcloud/server/issues/" rel="noreferrer nofollow">'},designteamLink(){return'<a target="_blank" href="https://nextcloud.com/design" rel="noreferrer nofollow">'}},watch:{shortcutsDisabled(e){this.changeShortcutsDisabled(e)}},methods:{refreshGlobalStyles(){[...document.head.querySelectorAll("link.theme")].forEach(e=>{const r=new URL(e.href);r.searchParams.set("v",Date.now());const n=e.cloneNode();n.href=r.toString(),n.onload=()=>e.remove(),document.head.append(n)})},updateBackground(e){this.background=e.type==="custom"||e.type==="default"?e.type:e.value,this.refreshGlobalStyles()},changeTheme({enabled:e,id:r}){this.themes.forEach(n=>{if(n.id===r&&e){n.enabled=!0;return}n.enabled=!1}),this.updateBodyAttributes(),this.selectItem(e,r)},changeFont({enabled:e,id:r}){this.fonts.forEach(n=>{if(n.id===r&&e){n.enabled=!0;return}n.enabled=!1}),this.updateBodyAttributes(),this.selectItem(e,r)},async changeShortcutsDisabled(e){e?await O({url:R("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"shortcuts_disabled"}),data:{configValue:"yes"},method:"POST"}):await O({url:R("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"shortcuts_disabled"}),method:"DELETE"})},updateBodyAttributes(){const e=this.themes.filter(n=>n.enabled===!0).map(n=>n.id),r=this.fonts.filter(n=>n.enabled===!0).map(n=>n.id);this.themes.forEach(n=>{document.body.toggleAttribute("data-theme-".concat(n.id),n.enabled)}),this.fonts.forEach(n=>{document.body.toggleAttribute("data-theme-".concat(n.id),n.enabled)}),document.body.setAttribute("data-themes",[...e,...r].join(","))},async selectItem(e,r){try{e?await O({url:R("apps/theming/api/v1/theme/{themeId}/enable",{themeId:r}),method:"PUT"}):await O({url:R("apps/theming/api/v1/theme/{themeId}",{themeId:r}),method:"DELETE"})}catch(n){console.error(n,n.response),OC.Notification.showTemporary(t("theming",n.response.data.ocs.meta.message+". Unable to apply the setting."))}}}};var vr=function(){var e=this,r=e._self._c;return r("section",[r("NcSettingsSection",{staticClass:"theming",attrs:{name:e.t("theming","Appearance and accessibility settings"),"limit-width":!1}},[r("p",{domProps:{innerHTML:e._s(e.description)}}),r("p",{domProps:{innerHTML:e._s(e.descriptionDetail)}}),r("div",{staticClass:"theming__preview-list"},e._l(e.themes,function(n){return r("ItemPreview",{key:n.id,attrs:{enforced:n.id===e.enforceTheme,selected:e.selectedTheme.id===n.id,theme:n,unique:e.themes.length===1,type:"theme"},on:{change:e.changeTheme}})}),1),r("div",{staticClass:"theming__preview-list"},e._l(e.fonts,function(n){return r("ItemPreview",{key:n.id,attrs:{selected:n.enabled,theme:n,unique:e.fonts.length===1,type:"font"},on:{change:e.changeFont}})}),1)]),r("NcSettingsSection",{staticClass:"background",attrs:{name:e.t("theming","Background"),"data-user-theming-background-disabled":""}},[e.isUserThemingDisabled?[r("p",[e._v(e._s(e.t("theming","Customization has been disabled by your administrator")))])]:[r("p",[e._v(e._s(e.t("theming","Set a custom background")))]),r("BackgroundSettings",{staticClass:"background__grid",on:{"update:background":e.refreshGlobalStyles}})]],2),r("NcSettingsSection",{attrs:{name:e.t("theming","Keyboard shortcuts")}},[r("p",[e._v(e._s(e.t("theming","In some cases keyboard shortcuts can interfere with accessibility tools. In order to allow focusing on your tool correctly you can disable all keyboard shortcuts here. This will also disable all available shortcuts in apps.")))]),r("NcCheckboxRadioSwitch",{staticClass:"theming__preview-toggle",attrs:{checked:e.shortcutsDisabled,type:"switch"},on:{"update:checked":function(n){e.shortcutsDisabled=n},change:e.changeShortcutsDisabled}},[e._v(" "+e._s(e.t("theming","Disable all keyboard shortcuts"))+" ")])],1),r("UserAppMenuSection")],1)},_r=[],yr=X(br,vr,_r,!1,null,"956d4cf9",null,null);const kr=yr.exports;Z.prototype.OC=OC,Z.prototype.t=t;const wr=Z.extend(kr),yt=new wr;yt.$mount("#theming"),yt.$on("update:background",Ht);
