/*! third party licenses: dist/vendor.LICENSE.txt */
window.addEventListener("DOMContentLoaded",()=>{$("#loglevel").change(function(){$.post(OC.generateUrl("/settings/admin/log/level"),{level:$(this).val()},()=>{OC.Log.reload()})}),$("#mail_smtpauth").change(function(){this.checked?$("#mail_credentials").removeClass("hidden"):$("#mail_credentials").addClass("hidden")}),$("#mail_smtpmode").change(function(){$(this).val()!=="smtp"?($("#setting_smtpauth").addClass("hidden"),$("#setting_smtphost").addClass("hidden"),$("#mail_smtpsecure_label").addClass("hidden"),$("#mail_smtpsecure").addClass("hidden"),$("#mail_credentials").addClass("hidden"),$("#mail_sendmailmode_label, #mail_sendmailmode").removeClass("hidden")):($("#setting_smtpauth").removeClass("hidden"),$("#setting_smtphost").removeClass("hidden"),$("#mail_smtpsecure_label").removeClass("hidden"),$("#mail_smtpsecure").removeClass("hidden"),$("#mail_smtpauth").is(":checked")&&$("#mail_credentials").removeClass("hidden"),$("#mail_sendmailmode_label, #mail_sendmailmode").addClass("hidden"))});const o=function(){if(OC.PasswordConfirmation.requiresPasswordConfirmation()){OC.PasswordConfirmation.requirePasswordConfirmation(o);return}OC.msg.startSaving("#mail_settings_msg"),$.ajax({url:OC.generateUrl("/settings/admin/mailsettings"),type:"POST",data:$("#mail_general_settings_form").serialize(),success:()=>{OC.msg.finishedSuccess("#mail_settings_msg",t("settings","Saved"))},error:e=>{OC.msg.finishedError("#mail_settings_msg",e.responseJSON)}})},m=function(){if(OC.PasswordConfirmation.requiresPasswordConfirmation()){OC.PasswordConfirmation.requirePasswordConfirmation(m);return}OC.msg.startSaving("#mail_settings_msg"),$.ajax({url:OC.generateUrl("/settings/admin/mailsettings/credentials"),type:"POST",data:$("#mail_credentials_settings").serialize(),success:()=>{OC.msg.finishedSuccess("#mail_settings_msg",t("settings","Saved"))},error:e=>{OC.msg.finishedError("#mail_settings_msg",e.responseJSON)}})};$("#mail_general_settings_form").change(o),$("#mail_credentials_settings_submit").click(m),$("#mail_smtppassword").click(()=>{(void 0).type==="text"&&(void 0).value==="********"&&((void 0).type="password",(void 0).value="")}),$("#sendtestemail").click(e=>{e.preventDefault(),OC.msg.startAction("#sendtestmail_msg",t("settings","Sendingâ€¦")),$.ajax({url:OC.generateUrl("/settings/admin/mailtest"),type:"POST",success:()=>{OC.msg.finishedSuccess("#sendtestmail_msg",t("settings","Email sent"))},error:l=>{OC.msg.finishedError("#sendtestmail_msg",l.responseJSON)}})});const h=()=>{$.when(OC.SetupChecks.checkWebDAV(),OC.SetupChecks.checkWellKnownUrl("GET","/.well-known/webfinger",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0,[200,404],!0),OC.SetupChecks.checkWellKnownUrl("GET","/.well-known/nodeinfo",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0,[200,404],!0),OC.SetupChecks.checkWellKnownUrl("PROPFIND","/.well-known/caldav",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0),OC.SetupChecks.checkWellKnownUrl("PROPFIND","/.well-known/carddav",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0),OC.SetupChecks.checkProviderUrl(OC.getRootPath()+"/ocm-provider/",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0),OC.SetupChecks.checkProviderUrl(OC.getRootPath()+"/ocs-provider/",OC.theme.docPlaceholderUrl,$("#postsetupchecks").data("check-wellknown")===!0),OC.SetupChecks.checkSetup(),OC.SetupChecks.checkGeneric(),OC.SetupChecks.checkWOFF2Loading(OC.filePath("core","","fonts/NotoSans-Regular-latin.woff2"),OC.theme.docPlaceholderUrl),OC.SetupChecks.checkDataProtected()).then((e,l,C,g,u,p,k,_,O,w,f)=>{const n=[].concat(e,l,C,g,u,p,k,_,O,w,f),d=$("#postsetupchecks");$("#security-warning-state-loading").addClass("hidden");let i=!1;const a=d.find(".errors"),r=d.find(".warnings"),c=d.find(".info");for(let s=0;s<n.length;s++)switch(n[s].type){case OC.SetupChecks.MESSAGE_TYPE_INFO:c.append("<li>"+n[s].msg+"</li>");break;case OC.SetupChecks.MESSAGE_TYPE_WARNING:r.append("<li>"+n[s].msg+"</li>");break;case OC.SetupChecks.MESSAGE_TYPE_ERROR:default:a.append("<li>"+n[s].msg+"</li>")}a.find("li").length>0&&(a.removeClass("hidden"),i=!0),r.find("li").length>0&&(r.removeClass("hidden"),i=!0),c.find("li").length>0&&(c.removeClass("hidden"),i=!0),i?($("#postsetupchecks-hint").removeClass("hidden"),a.find("li").length>0?$("#security-warning-state-failure").removeClass("hidden"):$("#security-warning-state-warning").removeClass("hidden")):$("#security-warning").children("ul").children().length===0?$("#security-warning-state-ok").removeClass("hidden"):$("#security-warning-state-failure").removeClass("hidden")})};document.getElementById("security-warning")!==null&&h()});
