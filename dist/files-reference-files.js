/*! For license information please see files-reference-files.js.LICENSE.txt */
!function(){"use strict";var e,r,i,n={94032:function(e,r,i){var n=i(20144),o=i(31352),s=(i(41604),i(59768)),c=i(79753),a=i(62520),l=i.n(a),u=i(25108),d={name:"ReferenceFileWidget",props:{richObject:{type:Object,required:!0},accessible:{type:Boolean,default:!0}},data:function(){return{previewUrl:window.OC.MimeType.getIconUrl(this.richObject.mimetype)}},computed:{fileSize:function(){return window.OC.Util.humanFileSize(this.richObject.size)},fileMtime:function(){return window.OC.Util.relativeModifiedDate(1e3*this.richObject.mtime)},filePath:function(){return l().dirname(this.richObject.path)},filePreview:function(){return this.previewUrl?{backgroundImage:"url("+this.previewUrl+")"}:{backgroundImage:"url("+window.OC.MimeType.getIconUrl(this.richObject.mimetype)+")"}},filePreviewClass:function(){return this.previewUrl?"widget-file--image--preview":"widget-file--image--icon"}},mounted:function(){var e=this;if(this.richObject["preview-available"]){var t=(0,c.generateUrl)("/core/preview?fileId={fileId}&x=250&y=250",{fileId:this.richObject.id}),r=new Image;r.onload=function(){e.previewUrl=t},r.onerror=function(e){u.error("could not load recommendation preview",e)},r.src=t}},methods:{navigate:function(){OCA.Viewer&&-1!==OCA.Viewer.mimetypes.indexOf(this.richObject.mimetype)?OCA.Viewer.open({path:this.richObject.path}):window.location=this.richObject.link}}},h=i(93379),p=i.n(h),f=i(7795),m=i.n(f),v=i(90569),g=i.n(v),y=i(3565),w=i.n(y),b=i(19216),A=i.n(b),C=i(44589),x=i.n(C),_=i(7574),k={};k.styleTagTransform=x(),k.setAttributes=w(),k.insert=g().bind(null,"head"),k.domAPI=m(),k.insertStyleElement=A(),p()(_.Z,k),_.Z&&_.Z.locals&&_.Z.locals;var P=i(51900),S=(0,P.Z)(d,(function(){var e=this,t=e._self._c;return e.accessible?t("a",{staticClass:"widget-file",attrs:{href:e.richObject.link},on:{click:function(t){return t.preventDefault(),e.navigate.apply(null,arguments)}}},[t("div",{staticClass:"widget-file--image",class:e.filePreviewClass,style:e.filePreview}),e._v(" "),t("div",{staticClass:"widget-file--details"},[t("p",{staticClass:"widget-file--title"},[e._v(e._s(e.richObject.name))]),e._v(" "),t("p",{staticClass:"widget-file--description"},[e._v(e._s(e.fileSize)),t("br"),e._v(e._s(e.fileMtime))]),e._v(" "),t("p",{staticClass:"widget-file--link"},[e._v(e._s(e.filePath))])])]):t("div",{staticClass:"widget-file widget-file--no-access"},[t("div",{staticClass:"widget-file--image widget-file--image--icon icon-folder"}),e._v(" "),t("div",{staticClass:"widget-file--details"},[t("p",{staticClass:"widget-file--title"},[e._v("\n\t\t\t"+e._s(e.t("files","File cannot be accessed"))+"\n\t\t")]),e._v(" "),t("p",{staticClass:"widget-file--description"},[e._v("\n\t\t\t"+e._s(e.t("files","You might not have have permissions to view it, ask the sender to share it"))+"\n\t\t")])])])}),[],!1,null,"3f729da0",null),I=S.exports,L=i(64024);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function O(){O=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof h?t:h,s=Object.create(o.prototype),c=new k(n||[]);return i(s,"_invoke",{value:A(e,r,c)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function h(){}function p(){}function f(){}var m={};a(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(P([])));g&&g!==t&&r.call(g,o)&&(m=g);var y=f.prototype=h.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(i,o,s,c){var a=u(e[i],e,o);if("throw"!==a.type){var l=a.arg,d=l.value;return d&&"object"==j(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(a.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function A(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var c=C(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var a=u(e,t,r);if("normal"===a.type){if(i=r.done?"completed":"suspendedYield",a.arg===d)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(i="completed",r.method="throw",r.arg=a.arg)}}}function C(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var n=u(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,i(y,"constructor",{value:f,configurable:!0}),i(f,"constructor",{value:p,configurable:!0}),p.displayName=a(f,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(b.prototype),a(b.prototype,s,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new b(l(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(y),a(y,c,"Generator"),a(y,o,(function(){return this})),a(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),a=r.call(o,"finallyLoc");if(c&&a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;_(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function N(e,t,r,i,n,o,s){try{var c=e[o](s),a=c.value}catch(e){return void r(e)}c.done?t(a):Promise.resolve(a).then(i,n)}var E={name:"FileReferencePickerElement",components:{},props:{providerId:{type:String,required:!0},accessible:{type:Boolean,default:!1}},mounted:function(){this.openFilePicker(),window.addEventListener("click",this.onWindowClick)},beforeDestroy:function(){window.removeEventListener("click",this.onWindowClick)},methods:{onWindowClick:function(e){"A"===e.target.tagName&&e.target.classList.contains("oc-dialog-close")&&this.$emit("cancel")},openFilePicker:function(){var e,r=this;return(e=O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:OC.dialogs.filepicker(t("files","Select file or folder to link to"),(function(e){OC.Files.getClient().getFileInfo(e).then((function(e,t){r.submit(t.id)}))}),!1,[],!1,L.K9.Choose,"",{target:r.$refs.picker});case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(e){N(o,i,n,s,c,"next",e)}function c(e){N(o,i,n,s,c,"throw",e)}s(void 0)}))})()},submit:function(e){var t=window.location.protocol+"//"+window.location.host+(0,c.generateUrl)("/f/{fileId}",{fileId:e});this.$emit("submit",t)}}},R=E,B=i(24056),M={};M.styleTagTransform=x(),M.setAttributes=w(),M.insert=g().bind(null,"head"),M.domAPI=m(),M.insertStyleElement=A(),p()(B.Z,M),B.Z&&B.Z.locals&&B.Z.locals;var Z=(0,P.Z)(R,(function(){return(0,this._self._c)("div",{ref:"picker",staticClass:"reference-file-picker"})}),[],!1,null,"2dd87592",null).exports;n.default.mixin({methods:{t:o.Iu}}),(0,s.r)("file",(function(e,t){var r=t.richObjectType,i=t.richObject,o=t.accessible;new(n.default.extend(I))({propsData:{richObjectType:r,richObject:i,accessible:o}}).$mount(e)})),(0,s.f)("files",(function(e,t){var r=t.providerId,i=t.accessible,o=new(n.default.extend(Z))({propsData:{providerId:r,accessible:i}}).$mount(e);return new s.e(o.$el,o)}),(function(e,t){t.object.$destroy()}))},24056:function(e,t,r){var i=r(87537),n=r.n(i),o=r(23645),s=r.n(o)()(n());s.push([e.id,".reference-file-picker[data-v-2dd87592]{flex-grow:1;padding:12px 16px 16px 16px}.reference-file-picker[data-v-2dd87592] .oc-dialog{transform:none !important;box-shadow:none !important;flex-grow:1 !important;position:static !important;width:100% !important;height:auto !important;padding:0 !important;max-width:initial}.reference-file-picker[data-v-2dd87592] .oc-dialog .oc-dialog-close{display:none}.reference-file-picker[data-v-2dd87592] .oc-dialog .oc-dialog-buttonrow.onebutton.aside{position:absolute;padding:12px 32px}.reference-file-picker[data-v-2dd87592] .oc-dialog .oc-dialog-content{max-width:100% !important}","",{version:3,sources:["webpack://./apps/files/src/views/FileReferencePickerElement.vue"],names:[],mappings:"AACA,wCACC,WAAA,CACA,2BAAA,CAEA,mDACC,yBAAA,CACA,0BAAA,CACA,sBAAA,CACA,0BAAA,CACA,qBAAA,CACA,sBAAA,CACA,oBAAA,CACA,iBAAA,CAEA,oEACC,YAAA,CAGD,wFACC,iBAAA,CACA,iBAAA,CAGD,sEACC,yBAAA",sourcesContent:["\n.reference-file-picker {\n\tflex-grow: 1;\n\tpadding: 12px 16px 16px 16px;\n\n\t&:deep(.oc-dialog) {\n\t\ttransform: none !important;\n\t\tbox-shadow: none !important;\n\t\tflex-grow: 1 !important;\n\t\tposition: static !important;\n\t\twidth: 100% !important;\n\t\theight: auto !important;\n\t\tpadding: 0 !important;\n\t\tmax-width: initial;\n\n\t\t.oc-dialog-close {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.oc-dialog-buttonrow.onebutton.aside {\n\t\t\tposition: absolute;\n\t\t\tpadding: 12px 32px;\n\t\t}\n\n\t\t.oc-dialog-content {\n\t\t\tmax-width: 100% !important;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),t.Z=s},7574:function(e,t,r){var i=r(87537),n=r.n(i),o=r(23645),s=r.n(o)()(n());s.push([e.id,".widget-file[data-v-3f729da0]{display:flex;flex-grow:1;color:var(--color-main-text) !important;text-decoration:none !important}.widget-file--image[data-v-3f729da0]{min-width:40%;background-position:center;background-size:cover;background-repeat:no-repeat}.widget-file--image.widget-file--image--icon[data-v-3f729da0]{min-width:88px;background-size:44px}.widget-file--title[data-v-3f729da0]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:bold}.widget-file--details[data-v-3f729da0]{padding:12px;flex-grow:1;display:flex;flex-direction:column}.widget-file--details p[data-v-3f729da0]{margin:0;padding:0}.widget-file--description[data-v-3f729da0]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.widget-file--link[data-v-3f729da0]{color:var(--color-text-maxcontrast)}.widget-file.widget-file--no-access[data-v-3f729da0]{padding:12px}.widget-file.widget-file--no-access .widget-file--details[data-v-3f729da0]{padding:0}","",{version:3,sources:["webpack://./apps/files/src/views/ReferenceFileWidget.vue"],names:[],mappings:"AACA,8BACC,YAAA,CACA,WAAA,CACA,uCAAA,CACA,+BAAA,CAEA,qCACC,aAAA,CACA,0BAAA,CACA,qBAAA,CACA,2BAAA,CAEA,8DACC,cAAA,CACA,oBAAA,CAIF,qCACC,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,gBAAA,CAGD,uCACC,YAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CAEA,yCACC,QAAA,CACA,SAAA,CAIF,2CACC,eAAA,CACA,sBAAA,CACA,mBAAA,CACA,oBAAA,CACA,YAAA,CACA,2BAAA,CAGD,oCACC,mCAAA,CAGD,qDACC,YAAA,CAEA,2EACC,SAAA",sourcesContent:["\n.widget-file {\n\tdisplay: flex;\n\tflex-grow: 1;\n\tcolor: var(--color-main-text) !important;\n\ttext-decoration: none !important;\n\n\t&--image {\n\t\tmin-width: 40%;\n\t\tbackground-position: center;\n\t\tbackground-size: cover;\n\t\tbackground-repeat: no-repeat;\n\n\t\t&.widget-file--image--icon {\n\t\t\tmin-width: 88px;\n\t\t\tbackground-size: 44px;\n\t\t}\n\t}\n\n\t&--title {\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\tfont-weight: bold;\n\t}\n\n\t&--details {\n\t\tpadding: 12px;\n\t\tflex-grow: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\n\t\tp {\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t}\n\t}\n\n\t&--description {\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tdisplay: -webkit-box;\n\t\t-webkit-line-clamp: 3;\n\t\tline-clamp: 3;\n\t\t-webkit-box-orient: vertical;\n\t}\n\n\t&--link {\n\t\tcolor: var(--color-text-maxcontrast);\n\t}\n\n\t&.widget-file--no-access {\n\t\tpadding: 12px;\n\n\t\t.widget-file--details {\n\t\t\tpadding: 0;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),t.Z=s},42761:function(e){e.exports="data:image/svg+xml;base64,PCEtLSBUaGlzIGljb24gaXMgcGFydCBvZiBNYXRlcmlhbCBVSSBJY29ucy4gQ29weXJpZ2h0IDIwMjAgR29vZ2xlIEluYy4sIEFwYWNoZS0yLjAgTGljZW5zZSAtLT4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZD0iTS00LTRoMjR2MjRILTRWLTR6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTggMEMzLjYgMCAwIDMuNiAwIDhzMy42IDggOCA4IDgtMy42IDgtOC0zLjYtOC04LTh6IiBmaWxsPSIjZWQ0ODRjIi8+PHBhdGggZD0iTTUgNi41aDZjLjggMCAxLjUuNyAxLjUgMS41cy0uNyAxLjUtMS41IDEuNUg1Yy0uOCAwLTEuNS0uNy0xLjUtMS41UzQuMiA2LjUgNSA2LjV6IiBmaWxsPSIjZmRmZmZmIi8+PC9zdmc+Cg=="},87210:function(e){e.exports="data:image/svg+xml;base64,PCEtLSBUaGlzIGljb24gaXMgcGFydCBvZiBNYXRlcmlhbCBVSSBJY29ucy4gQ29weXJpZ2h0IDIwMjAgR29vZ2xlIEluYy4sIEFwYWNoZS0yLjAgTGljZW5zZSAtLT4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZD0iTTQuOCAxMS4yaDYuNFY0LjhINC44djYuNHpNOCAwQzMuNiAwIDAgMy42IDAgOHMzLjYgOCA4IDggOC0zLjYgOC04LTMuNi04LTgtOHoiIGZpbGw9IiM0OWIzODIiLz48L3N2Zz4K"},94659:function(e){e.exports="data:image/svg+xml;base64,PCEtLSBUaGlzIGljb24gaXMgcGFydCBvZiBNYXRlcmlhbCBVSSBJY29ucy4gQ29weXJpZ2h0IDIwMjAgR29vZ2xlIEluYy4sIEFwYWNoZS0yLjAgTGljZW5zZSAtLT4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTS00LTRoMjR2MjRILTR6Ii8+PHBhdGggZD0iTTYuOS4xQzMgLjYtLjEgNC0uMSA4YzAgNC40IDMuNiA4IDggOCA0IDAgNy40LTMgOC02LjktMS4yIDEuMy0yLjkgMi4xLTQuNyAyLjEtMy41IDAtNi40LTIuOS02LjQtNi40IDAtMS45LjgtMy42IDIuMS00Ljd6IiBmaWxsPSIjZjRhMzMxIi8+PC9zdmc+Cg=="},41604:function(e,t,r){r.d(t,{N:function(){return I}});var i=r(59768),n=r(93664),o=r(79753),s=r(76311),c=r(28600),a=r(21955),l=r(10979),u=r(41074),d=r(38878),h=r(27172),p=r(20469),f=r(66875),m=r(72090),v=r(25108);const g=/(\s|^)(https?:\/\/)((?:[-A-Z0-9+_]+\.)+[-A-Z]+(?:\/[-A-Z0-9+&@#%?=~_|!:,.;()]*)*)(\s|$)/gi,y=/(\s|\(|^)((https?:\/\/)((?:[-A-Z0-9+_]+\.)+[-A-Z0-9]+(?::[0-9]+)?(?:\/[-A-Z0-9+&@#%?=~_|!:,.;()]*)*))(?=\s|\)|$)/gi,w={name:"NcReferenceList",components:{NcReferenceWidget:i.N},props:{text:{type:String,default:""},referenceData:{type:Object,default:null},limit:{type:Number,default:1}},data(){return{references:null,loading:!0}},computed:{isVisible(){return this.loading||this.displayedReferences},values(){return this.referenceData?this.referenceData:this.references?Object.values(this.references):[]},firstReference(){var e;return null!=(e=this.values[0])?e:null},displayedReferences(){return this.values.slice(0,this.limit)}},watch:{text:"fetch"},mounted(){this.fetch()},methods:{fetch(){this.loading=!0,this.referenceData?this.loading=!1:new RegExp(g).exec(this.text)?this.resolve().then((e=>{this.references=e.data.ocs.data.references,this.loading=!1})).catch((e=>{v.error("Failed to extract references",e),this.loading=!1})):this.loading=!1},resolve(){const e=new RegExp(g).exec(this.text.trim());return 1===this.limit&&e?n.Z.get((0,o.generateOcsUrl)("references/resolve",2)+`?reference=${encodeURIComponent(e[0])}`):n.Z.post((0,o.generateOcsUrl)("references/extract",2),{text:this.text,resolve:!0,limit:this.limit})}}};var b=function(){var e=this,t=e._self._c;return e.isVisible?t("div",{staticClass:"widgets--list",class:{"icon-loading":e.loading}},e._l(e.displayedReferences,(function(e){var r;return t("div",{key:null==(r=null==e?void 0:e.openGraphObject)?void 0:r.id},[t("NcReferenceWidget",{attrs:{reference:e}})],1)})),0):e._e()},A=[];const C=(0,s.n)(w,b,A,!1,null,"bd1fbb02",null,null).exports,x={name:"NcLink",props:{href:{type:String,required:!0}},render(e){return e("a",{attrs:{href:this.href,rel:"noopener noreferrer",target:"_blank",class:"rich-text--external-link"}},[this.href.trim()])}},_=function({autolink:e,useMarkdown:t}){return function(r){!t||!e||(0,c.Vn)(r,(e=>"text"===e.type),((e,t,r)=>{let i=k(e.value);return i=i.map((e=>"string"==typeof e?(0,l.u)("text",e):(0,l.u)("link",{url:e.props.href},[(0,l.u)("text",e.props.href)]))).filter((e=>e)),r.children.splice(t,1,...i.flat()),[a.AM,t+i.flat().length]}))}},k=e=>{let t=y.exec(e);const r=[];let i=0;for(;null!==t;){let n,o=t[2],s=e.substring(i,t.index+t[1].length);" "===o[0]&&(s+=o[0],o=o.substring(1).trim());const c=o[o.length-1];("."===c||","===c||";"===c||"("===t[0][0]&&")"===c)&&(o=o.substring(0,o.length-1),n=c),r.push(s),r.push({component:x,props:{href:o}}),n&&r.push(n),i=t.index+t[0].length,t=y.exec(e)}return r.push(e.substring(i)),e===r.map((e=>"string"==typeof e?e:e.props.href)).join("")?r:(v.error("Failed to reassemble the chunked text: "+e),e)},P=function(){return function(e){(0,c.Vn)(e,(e=>"text"===e.type),(function(e,t,r){const i=e.value.split(/(\{[a-z\-_.0-9]+\})/gi).map(((e,t,r)=>{const i=e.match(/^\{([a-z\-_.0-9]+)\}$/i);if(!i)return(0,l.u)("text",e);const[,n]=i;return(0,l.u)("element",{tagName:`#${n}`})}));r.children.splice(t,1,...i)}))}},S={name:"NcRichText",components:{NcReferenceList:C},props:{text:{type:String,default:""},arguments:{type:Object,default:()=>({})},referenceLimit:{type:Number,default:0},references:{type:Object,default:null},markdownCssClasses:{type:Object,default:()=>({a:"rich-text--external-link",ol:"rich-text--ordered-list",ul:"rich-text--un-ordered-list",li:"rich-text--list-item",strong:"rich-text--strong",em:"rich-text--italic",h1:"rich-text--heading rich-text--heading-1",h2:"rich-text--heading rich-text--heading-2",h3:"rich-text--heading rich-text--heading-3",h4:"rich-text--heading rich-text--heading-4",h5:"rich-text--heading rich-text--heading-5",h6:"rich-text--heading rich-text--heading-6",hr:"rich-text--hr",table:"rich-text--table",pre:"rich-text--pre",code:"rich-text--code",blockquote:"rich-text--blockquote"})},useMarkdown:{type:Boolean,default:!1},autolink:{type:Boolean,default:!0}},methods:{renderPlaintext(e){const t=this,r=this.text.split(/(\{[a-z\-_.0-9]+\})/gi).map((function(r,i,n){const o=r.match(/^\{([a-z\-_.0-9]+)\}$/i);if(!o)return(({h:e,context:t},r)=>(t.autolink&&(r=k(r)),Array.isArray(r)?r.map((t=>{if("string"==typeof t)return t;const{component:r,props:i}=t,n="NcLink"===r.name?void 0:"rich-text--component";return e(r,{props:i,class:n})})):r))({h:e,context:t},r);const s=o[1],c=t.arguments[s];if("object"==typeof c){const{component:t,props:r}=c;return e(t,{props:r,class:"rich-text--component"})}return c?e("span",{class:"rich-text--fallback"},c):r}));return e("div",{class:"rich-text--wrapper"},[e("div",{},r.flat()),this.referenceLimit>0?e("div",{class:"rich-text--reference-widget"},[e(C,{props:{text:this.text,referenceData:this.references}})]):null])},renderMarkdown(e){const t=(0,u.l)().use(d.Z).use(_,{autolink:this.autolink,useMarkdown:this.useMarkdown}).use(h.Z).use(p.Z,{handlers:{component(e,t){return e(t,t.component,{value:t.value})}}}).use(P).use(m.Z,{target:"_blank",rel:["noopener noreferrer"]}).use(f.Z,{createElement:(t,r,i)=>{if(i=null==i?void 0:i.map((e=>"string"==typeof e?e.replace(/&lt;/gim,"<"):e)),!t.startsWith("#"))return e(t,r,i);const n=this.arguments[t.slice(1)];return n?n.component?e(n.component,{attrs:r,props:n.props,class:"rich-text--component"},i):e("span",r,[n]):e("span",{attrs:r,class:"rich-text--fallback"},[`{${t.slice(1)}}`])},prefix:!1}).processSync(this.text.replace(/</gim,"&lt;").replace(/&gt;/gim,">")).result;return e("div",{class:"rich-text--wrapper rich-text--wrapper-markdown"},[t,this.referenceLimit>0?e("div",{class:"rich-text--reference-widget"},[e(C,{props:{text:this.text,referenceData:this.references}})]):null])}},render(e){return this.useMarkdown?this.renderMarkdown(e):this.renderPlaintext(e)}},I=(0,s.n)(S,null,null,!1,null,"5f33f45b",null,null).exports},59768:function(e,t,r){r.d(t,{N:function(){return P},e:function(){return S},f:function(){return L},j:function(){return de},n:function(){return Z},r:function(){return C}}),r(47522);var i=r(76311),n=r(74917),o=r(93664),s=r(43554),c=r(79753),a=r(86514),l=r(40873),u=r(61537),d=r(25751),h=r(20435),p=r(49368),f=r(89115),m=r(57274),v=r(6136),g=r(69183),y=r(32219),w=r(82675),b=r(20144),A=r(25108);window._vue_richtext_widgets||(window._vue_richtext_widgets={});const C=(e,t,r=(e=>{}))=>{window._vue_richtext_widgets[e]?A.error("Widget for id "+e+" already registered"):window._vue_richtext_widgets[e]={id:e,callback:t,onDestroy:r}};window._registerWidget=C;const x={name:"NcReferenceWidget",props:{reference:{type:Object,required:!0}},data(){return{compact:3}},computed:{hasCustomWidget(){return(e=>!!window._vue_richtext_widgets[e])(this.reference.richObjectType)},noAccess(){return this.reference&&!this.reference.accessible},descriptionStyle(){if(0===this.compact)return{display:"none"};const e=this.compact<4?this.compact:3;return{lineClamp:e,webkitLineClamp:e}},compactLink(){const e=this.reference.openGraphObject.link;return e?e.startsWith("https://")?e.substring(8):e.startsWith("http://")?e.substring(7):e:""}},mounted(){this.renderWidget(),this.observer=new ResizeObserver((e=>{e[0].contentRect.width<450?this.compact=0:e[0].contentRect.width<550?this.compact=1:e[0].contentRect.width<650?this.compact=2:this.compact=3})),this.observer.observe(this.$el)},beforeDestroy(){this.observer.disconnect(),((e,t)=>{"open-graph"!==e&&window._vue_richtext_widgets[e]&&window._vue_richtext_widgets[e].onDestroy(t)})(this.reference.richObjectType,this.$el)},methods:{renderWidget(){var e;this.$refs.customWidget&&(this.$refs.customWidget.innerHTML=""),"open-graph"!==(null==(e=null==this?void 0:this.reference)?void 0:e.richObjectType)&&this.$nextTick((()=>{((e,{richObjectType:t,richObject:r,accessible:i})=>{if("open-graph"!==t){if(!window._vue_richtext_widgets[t])return void A.error("Widget for rich object type "+t+" not registered");window._vue_richtext_widgets[t].callback(e,{richObjectType:t,richObject:r,accessible:i})}})(this.$refs.customWidget,this.reference)}))}}};var _=function(){var e=this,t=e._self._c;return t("div",[e.reference&&e.hasCustomWidget?t("div",{staticClass:"widget-custom"},[t("div",{ref:"customWidget"})]):!e.noAccess&&e.reference&&e.reference.openGraphObject&&!e.hasCustomWidget?t("a",{staticClass:"widget-default",attrs:{href:e.reference.openGraphObject.link,rel:"noopener noreferrer",target:"_blank"}},[e.reference.openGraphObject.thumb?t("img",{staticClass:"widget-default--image",attrs:{src:e.reference.openGraphObject.thumb}}):e._e(),t("div",{staticClass:"widget-default--details"},[t("p",{staticClass:"widget-default--name"},[e._v(e._s(e.reference.openGraphObject.name))]),t("p",{staticClass:"widget-default--description",style:e.descriptionStyle},[e._v(e._s(e.reference.openGraphObject.description))]),t("p",{staticClass:"widget-default--link"},[e._v(e._s(e.compactLink))])])]):e._e()])},k=[];const P=(0,i.n)(x,_,k,!1,null,"b1c5a80f",null,null).exports;window._vue_richtext_custom_picker_elements||(window._vue_richtext_custom_picker_elements={});class S{constructor(e,t){this.element=e,this.object=t}}const I=e=>!!window._vue_richtext_custom_picker_elements[e],L=(e,t,r=(e=>{}),i="large")=>{window._vue_richtext_custom_picker_elements[e]?A.error("Custom reference picker element for id "+e+" already registered"):window._vue_richtext_custom_picker_elements[e]={id:e,callback:t,onDestroy:r,size:i}};window._registerCustomPickerElement=L;const j={name:"NcCustomPickerElement",props:{provider:{type:Object,required:!0}},emits:["cancel","submit"],data(){return{isRegistered:I(this.provider.id),renderResult:null}},mounted(){this.isRegistered&&this.renderElement()},beforeDestroy(){this.isRegistered&&((e,t,r)=>{window._vue_richtext_custom_picker_elements[e]&&window._vue_richtext_custom_picker_elements[e].onDestroy(t,r)})(this.provider.id,this.$el,this.renderResult)},methods:{renderElement(){this.$refs.domElement&&(this.$refs.domElement.innerHTML="");const e=((e,{providerId:t,accessible:r})=>{if(window._vue_richtext_custom_picker_elements[t])return window._vue_richtext_custom_picker_elements[t].callback(e,{providerId:t,accessible:r});A.error("Custom reference picker element for reference provider ID "+t+" not registered")})(this.$refs.domElement,{providerId:this.provider.id,accessible:!1});Promise.resolve(e).then((e=>{var t,r;this.renderResult=e,null!=(t=this.renderResult.object)&&t._isVue&&null!=(r=this.renderResult.object)&&r.$on&&(this.renderResult.object.$on("submit",this.onSubmit),this.renderResult.object.$on("cancel",this.onCancel)),this.renderResult.element.addEventListener("submit",(e=>{this.onSubmit(e.detail)})),this.renderResult.element.addEventListener("cancel",this.onCancel)}))},onSubmit(e){this.$emit("submit",e)},onCancel(){this.$emit("cancel")}}};var O=function(){return(0,this._self._c)("div",{ref:"domElement"})},N=[];const E=(0,i.n)(j,O,N,!1,null,"cf695ff9",null,null).exports,R="any-link",B={id:R,title:(0,n.t)("Any link"),icon_url:(0,c.imagePath)("core","filetypes/link.svg")};function M(){return window._vue_richtext_reference_providers.filter((e=>{const t=!!e.search_providers_ids&&e.search_providers_ids.length>0||I(e.id);return t||A.debug("[smart picker]",e.id,"reference provider is discoverable but does not have any related search provider or custom picker component registered"),t}))}function Z(e,t=null){const r=M(),i=e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(i,"i"),o=function(e){const t=window._vue_richtext_reference_provider_timestamps;return e.sort(((e,t)=>e.order===t.order?0:e.order>t.order?1:-1)).sort(((e,r)=>{const i=t[e.id],n=t[r.id];return i===n?0:void 0===n?-1:void 0===i?1:i>n?-1:1}))}(r).filter((e=>e.title.match(n))),s=t?o.slice(0,t):o;return(""===e||0===s.length)&&s.push(B),s}window._vue_richtext_reference_providers||(window._vue_richtext_reference_providers=(0,s.j)("core","reference-provider-list",[])),window._vue_richtext_reference_provider_timestamps||(window._vue_richtext_reference_provider_timestamps=(0,s.j)("core","reference-provider-timestamps",{}));let T=0;function D(e,t){return function(){const r=this,i=arguments;clearTimeout(T),T=setTimeout((function(){e.apply(r,i)}),t||0)}}function $(e){try{return!!new URL(e)}catch{return!1}}const z={name:"NcProviderList",components:{NcSelect:u.Z,NcHighlight:l.N,NcEmptyContent:a.Z,LinkVariantIcon:d.default},emits:["select-provider","submit"],data(){return{selectedProvider:null,query:"",multiselectPlaceholder:(0,n.t)("Select provider"),providerIconAlt:(0,n.t)("Provider icon")}},computed:{options(){const e=[];return""!==this.query&&$(this.query)&&e.push({id:this.query,title:this.query,isLink:!0}),e.push(...Z(this.query)),e}},methods:{focus(){setTimeout((()=>{var e,t,r;null==(r=null==(t=null==(e=this.$refs["provider-select"])?void 0:e.$el)?void 0:t.querySelector("#provider-select-input"))||r.focus()}),300)},onProviderSelected(e){null!==e&&(e.isLink?this.$emit("submit",e.title):this.$emit("select-provider",e),this.selectedProvider=null)},onSearch(e,t){this.query=e}}};var W=function(){var e=this,t=e._self._c;return t("div",{staticClass:"provider-list"},[t("NcSelect",{ref:"provider-select",staticClass:"provider-list--select",attrs:{"input-id":"provider-select-input",label:"title",placeholder:e.multiselectPlaceholder,options:e.options,"append-to-body":!1,"clear-search-on-select":!0,"clear-search-on-blur":()=>!1,filterable:!1},on:{search:e.onSearch,input:e.onProviderSelected},scopedSlots:e._u([{key:"option",fn:function(r){return[r.isLink?t("div",{staticClass:"provider"},[t("LinkVariantIcon",{staticClass:"link-icon",attrs:{size:20}}),t("span",[e._v(e._s(r.title))])],1):t("div",{staticClass:"provider"},[t("img",{staticClass:"provider-icon",attrs:{src:r.icon_url,alt:e.providerIconAlt}}),t("NcHighlight",{staticClass:"option-text",attrs:{search:e.query,text:r.title}})],1)]}}]),model:{value:e.selectedProvider,callback:function(t){e.selectedProvider=t},expression:"selectedProvider"}}),t("NcEmptyContent",{staticClass:"provider-list--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[t("LinkVariantIcon")]},proxy:!0}])})],1)},G=[];const U=(0,i.n)(z,W,G,!1,null,"9d850ea5",null,null).exports,q={name:"NcRawLinkInput",components:{LinkVariantIcon:d.default,NcEmptyContent:a.Z,NcLoadingIcon:h.Z,NcReferenceWidget:P,NcTextField:p.Z},props:{provider:{type:Object,required:!0}},emits:["submit"],data(){return{inputValue:"",loading:!1,reference:null,abortController:null,inputPlaceholder:(0,n.t)("Enter link")}},computed:{isLinkValid(){return $(this.inputValue)}},methods:{focus(){var e;null==(e=this.$refs["url-input"].$el.getElementsByTagName("input")[0])||e.focus()},onSubmit(e){const t=e.target.value;this.isLinkValid&&this.$emit("submit",t)},onClear(){this.inputValue="",this.reference=null},onInput(){this.reference=null,this.abortController&&this.abortController.abort(),this.isLinkValid&&D((()=>{this.updateReference()}),500)()},updateReference(){this.loading=!0,this.abortController=new AbortController,o.Z.get((0,c.generateOcsUrl)("references/resolve",2)+"?reference="+encodeURIComponent(this.inputValue),{signal:this.abortController.signal}).then((e=>{this.reference=e.data.ocs.data.references[this.inputValue]})).catch((e=>{A.error(e)})).then((()=>{this.loading=!1}))}}};var V=function(){var e=this,t=e._self._c;return t("div",{staticClass:"raw-link"},[t("div",{staticClass:"input-wrapper"},[t("NcTextField",{ref:"url-input",attrs:{value:e.inputValue,"show-trailing-button":""!==e.inputValue,label:e.inputPlaceholder},on:{"update:value":[function(t){e.inputValue=t},e.onInput],"trailing-button-click":e.onClear},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}}},[e.loading?t("NcLoadingIcon",{attrs:{size:16}}):t("LinkVariantIcon",{attrs:{size:16}})],1)],1),null!==e.reference?t("NcReferenceWidget",{staticClass:"reference-widget",attrs:{reference:e.reference}}):t("NcEmptyContent",{staticClass:"raw-link--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[e.provider.icon_url?t("img",{staticClass:"provider-icon",attrs:{src:e.provider.icon_url}}):t("LinkVariantIcon")]},proxy:!0}])})],1)},Y=[];const F=(0,i.n)(q,V,Y,!1,null,"d0ba247a",null,null).exports,H={name:"NcSearchResult",components:{NcHighlight:l.N},props:{entry:{type:Object,required:!0},query:{type:String,required:!0}}};var Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"result"},[e.entry.icon?t("div",{staticClass:"result--icon-class",class:{[e.entry.icon]:!0,rounded:e.entry.rounded}}):t("img",{staticClass:"result--image",class:{rounded:e.entry.rounded},attrs:{src:e.entry.thumbnailUrl}}),t("div",{staticClass:"result--content"},[t("span",{staticClass:"result--content--name"},[t("NcHighlight",{attrs:{search:e.query,text:e.entry.title}})],1),t("span",{staticClass:"result--content--subline"},[t("NcHighlight",{attrs:{search:e.query,text:e.entry.subline}})],1)])])},X=[];const J=(0,i.n)(H,Q,X,!1,null,"7a394a58",null,null).exports,K={name:"NcSearch",components:{LinkVariantIcon:d.default,DotsHorizontalIcon:f.default,NcEmptyContent:a.Z,NcSelect:u.Z,NcSearchResult:J},props:{provider:{type:Object,required:!0},showEmptyContent:{type:Boolean,default:!0},searchPlaceholder:{type:String,default:null}},emits:["submit"],data(){return{searchQuery:"",selectedResult:null,resultsBySearchProvider:{},searching:!1,searchingMoreOf:null,abortController:null,noOptionsText:(0,n.t)("Start typing to search"),providerIconAlt:(0,n.t)("Provider icon")}},computed:{mySearchPlaceholder(){return this.searchPlaceholder||(0,n.t)("Search")},searchProviderIds(){return this.provider.search_providers_ids},options(){if(""===this.searchQuery)return[];const e=[];return $(this.searchQuery)&&e.push(this.rawLinkEntry),e.push(...this.formattedSearchResults),e},rawLinkEntry(){return{id:"rawLinkEntry",resourceUrl:this.searchQuery,isRawLink:!0}},formattedSearchResults(){const e=[];return this.searchProviderIds.forEach((t=>{if(this.resultsBySearchProvider[t].entries.length>0){(this.searchProviderIds.length>1||this.resultsBySearchProvider[t].entries.length>1)&&e.push({id:"groupTitle-"+t,name:this.resultsBySearchProvider[t].name,isCustomGroupTitle:!0,providerId:t});const r=this.resultsBySearchProvider[t].entries.map(((e,r)=>({id:"provider-"+t+"-entry-"+r,...e})));e.push(...r),this.resultsBySearchProvider[t].isPaginated&&e.push({id:"moreOf-"+t,name:this.resultsBySearchProvider[t].name,isMore:!0,providerId:t,isLoading:this.searchingMoreOf===t})}})),e}},mounted(){this.resetResults()},beforeDestroy(){this.cancelSearchRequests()},methods:{t:n.t,resetResults(){const e={};this.searchProviderIds.forEach((t=>{e[t]={entries:[]}})),this.resultsBySearchProvider=e},focus(){setTimeout((()=>{var e,t,r;null==(r=null==(t=null==(e=this.$refs["search-select"])?void 0:e.$el)?void 0:t.querySelector("#search-select-input"))||r.focus()}),300)},cancelSearchRequests(){this.abortController&&this.abortController.abort()},onSearchInput(e,t){this.searchQuery=e,D((()=>{this.updateSearch()}),500)()},onSelectResultSelected(e){null!==e&&(e.resourceUrl?(this.cancelSearchRequests(),this.$emit("submit",e.resourceUrl)):e.isMore&&this.searchMoreOf(e.providerId).then((()=>{this.selectedResult=null})))},searchMoreOf(e){return this.searchingMoreOf=e,this.cancelSearchRequests(),this.searchProviders(e)},updateSearch(){if(this.cancelSearchRequests(),this.resetResults(),""!==this.searchQuery)return this.searchProviders();this.searching=!1},searchProviders(e=null){var t,r;this.abortController=new AbortController,this.searching=!0;const i=null===e?[...this.searchProviderIds].map((e=>this.searchOneProvider(e))):[this.searchOneProvider(e,null!=(r=null==(t=this.resultsBySearchProvider[e])?void 0:t.cursor)?r:null)];return Promise.allSettled(i).then((e=>{e.find((e=>"rejected"===e.status&&("CanceledError"===e.reason.name||"ERR_CANCELED"===e.reason.code)))||(this.searching=!1,this.searchingMoreOf=null)}))},searchOneProvider(e,t=null){const r=null===t?(0,c.generateOcsUrl)("search/providers/{providerId}/search?term={term}&limit={limit}",{providerId:e,term:this.searchQuery,limit:5}):(0,c.generateOcsUrl)("search/providers/{providerId}/search?term={term}&limit={limit}&cursor={cursor}",{providerId:e,term:this.searchQuery,limit:5,cursor:t});return o.Z.get(r,{signal:this.abortController.signal}).then((t=>{const r=t.data.ocs.data;this.resultsBySearchProvider[e].name=r.name,this.resultsBySearchProvider[e].cursor=r.cursor,this.resultsBySearchProvider[e].isPaginated=r.isPaginated,this.resultsBySearchProvider[e].entries.push(...r.entries)}))}}};var ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"smart-picker-search",class:{"with-empty-content":e.showEmptyContent}},[t("NcSelect",{ref:"search-select",staticClass:"smart-picker-search--select",attrs:{"input-id":"search-select-input",label:"name",placeholder:e.mySearchPlaceholder,options:e.options,"append-to-body":!1,"close-on-select":!1,"clear-search-on-select":!1,"clear-search-on-blur":()=>!1,"reset-focus-on-options-change":!1,filterable:!1,autoscroll:!0,"reset-on-options-change":!1,loading:e.searching},on:{search:e.onSearchInput,input:e.onSelectResultSelected},scopedSlots:e._u([{key:"option",fn:function(r){return[r.isRawLink?t("div",{staticClass:"custom-option"},[t("LinkVariantIcon",{staticClass:"option-simple-icon",attrs:{size:20}}),t("span",{staticClass:"option-text"},[e._v(" "+e._s(e.t("Raw link {options}",{options:r.resourceUrl}))+" ")])],1):r.resourceUrl?t("NcSearchResult",{staticClass:"search-result",attrs:{entry:r,query:e.searchQuery}}):r.isCustomGroupTitle?t("span",{staticClass:"custom-option group-name"},[e.provider.icon_url?t("img",{staticClass:"provider-icon group-name-icon",attrs:{src:e.provider.icon_url}}):e._e(),t("span",{staticClass:"option-text"},[t("strong",[e._v(e._s(r.name))])])]):r.isMore?t("span",{class:{"custom-option":!0}},[r.isLoading?t("span",{staticClass:"option-simple-icon icon-loading-small"}):t("DotsHorizontalIcon",{staticClass:"option-simple-icon",attrs:{size:20}}),t("span",{staticClass:"option-text"},[e._v(" "+e._s(e.t('Load more "{options}"',{options:r.name}))+" ")])],1):e._e()]}},{key:"no-options",fn:function(){return[e._v(" "+e._s(e.noOptionsText)+" ")]},proxy:!0}]),model:{value:e.selectedResult,callback:function(t){e.selectedResult=t},expression:"selectedResult"}}),e.showEmptyContent?t("NcEmptyContent",{staticClass:"smart-picker-search--empty-content",scopedSlots:e._u([{key:"icon",fn:function(){return[e.provider.icon_url?t("img",{staticClass:"provider-icon",attrs:{alt:e.providerIconAlt,src:e.provider.icon_url}}):t("LinkVariantIcon")]},proxy:!0}],null,!1,2922132592)}):e._e()],1)},te=[];const re=(0,i.n)(K,ee,te,!1,null,"97d196f0",null,null).exports,ie={providerList:1,standardLinkInput:2,searchInput:3,customElement:4},ne={name:"NcReferencePicker",components:{NcCustomPickerElement:E,NcProviderList:U,NcRawLinkInput:F,NcSearch:re},props:{initialProvider:{type:Object,default:()=>null},width:{type:Number,default:null},focusOnCreate:{type:Boolean,default:!0}},emits:["cancel","cancel-raw-link","cancel-search","provider-selected","submit"],data(){return{MODES:ie,selectedProvider:this.initialProvider}},computed:{mode(){return null===this.selectedProvider?ie.providerList:I(this.selectedProvider.id)?ie.customElement:this.selectedProvider.search_providers_ids?ie.searchInput:ie.standardLinkInput},pickerWrapperStyle(){return{width:this.width?this.width+"px":void 0}}},mounted(){this.focusOnCreate&&(this.initialProvider?setTimeout((()=>{var e;null==(e=this.$refs["url-input"])||e.focus()}),300):this.$nextTick((()=>{var e;null==(e=this.$refs["provider-list"])||e.focus()})))},methods:{onEscapePressed(){null!==this.selectedProvider?this.deselectProvider():this.cancelProviderSelection()},onProviderSelected(e){this.selectedProvider=e,this.$emit("provider-selected",e),this.$nextTick((()=>{var e;null==(e=this.$refs["url-input"])||e.focus()}))},cancelCustomElement(){this.deselectProvider()},cancelSearch(){var e;this.$emit("cancel-search",null==(e=this.selectedProvider)?void 0:e.title),this.deselectProvider()},cancelRawLinkInput(){var e;this.$emit("cancel-raw-link",null==(e=this.selectedProvider)?void 0:e.title),this.deselectProvider()},cancelProviderSelection(){this.$emit("cancel")},submitLink(e){null!==this.selectedProvider&&function(e){const t=Math.floor(Date.now()/1e3),r={timestamp:t},i=(0,c.generateOcsUrl)("references/provider/{providerId}",{providerId:e});o.Z.put(i,r).then((r=>{window._vue_richtext_reference_provider_timestamps[e]=t}))}(this.selectedProvider.id),this.$emit("submit",e),this.deselectProvider()},deselectProvider(){this.selectedProvider=null,this.$emit("provider-selected",null),setTimeout((()=>{var e;null==(e=this.$refs["provider-list"])||e.focus()}),300)}}};var oe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reference-picker",style:e.pickerWrapperStyle,attrs:{tabindex:"-1"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:(t.stopPropagation(),t.preventDefault(),e.onEscapePressed.apply(null,arguments))}}},[e.mode===e.MODES.providerList?t("NcProviderList",{ref:"provider-list",on:{"select-provider":e.onProviderSelected,submit:e.submitLink,cancel:e.cancelProviderSelection}}):e.mode===e.MODES.standardLinkInput?t("NcRawLinkInput",{ref:"url-input",attrs:{provider:e.selectedProvider},on:{submit:e.submitLink,cancel:e.cancelRawLinkInput}}):e.mode===e.MODES.searchInput?t("NcSearch",{ref:"url-input",attrs:{provider:e.selectedProvider},on:{cancel:e.cancelSearch,submit:e.submitLink}}):e.mode===e.MODES.customElement?t("div",{staticClass:"custom-element-wrapper"},[t("NcCustomPickerElement",{attrs:{provider:e.selectedProvider},on:{submit:e.submitLink,cancel:e.cancelCustomElement}})],1):e._e()],1)},se=[];const ce={name:"NcReferencePickerModal",components:{NcReferencePicker:(0,i.n)(ne,oe,se,!1,null,"aa77d0d3",null,null).exports,NcModal:v.Z,NcButton:m.Z,ArrowLeftIcon:y.default,CloseIcon:w.default},props:{initialProvider:{type:Object,default:()=>null},focusOnCreate:{type:Boolean,default:!0},isInsideViewer:{type:Boolean,default:!1}},emits:["cancel","submit"],data(){return{show:!0,selectedProvider:this.initialProvider,backButtonTitle:(0,n.t)("Back to provider selection"),closeButtonTitle:(0,n.t)("Close"),closeButtonLabel:(0,n.t)("Close Smart Picker")}},computed:{isProviderSelected(){return null!==this.selectedProvider},showBackButton(){return null===this.initialProvider&&this.isProviderSelected},modalSize(){var e;return this.isProviderSelected&&I(this.selectedProvider.id)?null!=(e=(e=>{var t;const r=null==(t=window._vue_richtext_custom_picker_elements[e])?void 0:t.size;return["small","normal","large","full"].includes(r)?r:null})(this.selectedProvider.id))?e:"large":"normal"},showModalName(){return!this.isProviderSelected||!I(this.selectedProvider.id)},modalName(){return this.isProviderSelected?this.selectedProvider.title:(0,n.t)("Smart Picker")}},mounted(){if(this.isInsideViewer){const e=this.$refs.modal_content;(0,g.j8)("viewer:trapElements:changed",e)}},methods:{onCancel(){this.show=!1,this.$emit("cancel")},onSubmit(e){this.show=!1,this.$emit("submit",e)},onProviderSelect(e){this.selectedProvider=e,null===e&&null!==this.initialProvider&&this.onCancel()},onBackClicked(){this.$refs.referencePicker.deselectProvider()}}};var ae=function(){var e=this,t=e._self._c;return e.show?t("NcModal",{staticClass:"reference-picker-modal",attrs:{size:e.modalSize,"can-close":!1},on:{close:e.onCancel}},[t("div",{ref:"modal_content",staticClass:"reference-picker-modal--content"},[e.showBackButton?t("NcButton",{staticClass:"back-button",attrs:{"aria-label":e.backButtonTitle,title:e.backButtonTitle},on:{click:e.onBackClicked},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ArrowLeftIcon")]},proxy:!0}],null,!1,3001860362)}):e._e(),t("NcButton",{staticClass:"close-button",attrs:{"aria-label":e.closeButtonLabel,title:e.closeButtonTitle,type:"tertiary"},on:{click:e.onCancel},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CloseIcon")]},proxy:!0}],null,!1,2491825086)}),e.showModalName?t("h2",[e._v(" "+e._s(e.modalName)+" ")]):e._e(),t("NcReferencePicker",{ref:"referencePicker",attrs:{"initial-provider":e.initialProvider,"focus-on-create":e.focusOnCreate},on:{"provider-selected":e.onProviderSelect,submit:e.onSubmit,cancel:e.onCancel}})],1)]):e._e()},le=[];const ue=(0,i.n)(ce,ae,le,!1,null,"3f1a4ac7",null,null).exports;async function de(e=null,t=void 0){return await new Promise(((r,i)=>{var n;const o=document.createElement("div");o.id="referencePickerModal",document.body.append(o);const s=null===e?null:null!=(n=function(e){return e===R?B:M().find((t=>t.id===e))}(e))?n:null,c=new(b.default.extend(ue))({propsData:{initialProvider:s,isInsideViewer:t}}).$mount(o);c.$on("cancel",(()=>{c.$destroy(),i(new Error("User cancellation"))})),c.$on("submit",(e=>{c.$destroy(),r(e)}))}))}}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,loaded:!1,exports:{}};return n[e].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=n,e=[],s.O=function(t,r,i,n){if(!r){var o=1/0;for(u=0;u<e.length;u++){r=e[u][0],i=e[u][1],n=e[u][2];for(var c=!0,a=0;a<r.length;a++)(!1&n||o>=n)&&Object.keys(s.O).every((function(e){return s.O[e](r[a])}))?r.splice(a--,1):(c=!1,n<o&&(o=n));if(c){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[r,i,n]},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,r){return s.f[r](e,t),t}),[]))},s.u=function(e){return e+"-"+e+".js?v="+{2250:"34f75a254de23027f023",7608:"581ec51a56b912a9b3d4"}[e]},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r={},i="nextcloud:",s.l=function(e,t,n,o){if(r[e])r[e].push(t);else{var c,a;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){c=d;break}}c||(a=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.setAttribute("data-webpack",i+n),c.src=e),r[e]=[t];var h=function(t,i){c.onerror=c.onload=null,clearTimeout(p);var n=r[e];if(delete r[e],c.parentNode&&c.parentNode.removeChild(c),n&&n.forEach((function(e){return e(i)})),t)return t(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=h.bind(null,c.onerror),c.onload=h.bind(null,c.onload),a&&document.head.appendChild(c)}},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},s.j=9098,function(){var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e}(),function(){s.b=document.baseURI||self.location.href;var e={9098:0};s.f.j=function(t,r){var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var n=new Promise((function(r,n){i=e[t]=[r,n]}));r.push(i[2]=n);var o=s.p+s.u(t),c=new Error;s.l(o,(function(r){if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;c.message="Loading chunk "+t+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,i[1](c)}}),"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,n,o=r[0],c=r[1],a=r[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(i in c)s.o(c,i)&&(s.m[i]=c[i]);if(a)var u=a(s)}for(t&&t(r);l<o.length;l++)n=o[l],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(u)},r=self.webpackChunknextcloud=self.webpackChunknextcloud||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),s.nc=void 0;var c=s.O(void 0,[7874],(function(){return s(94032)}));c=s.O(c)}();
//# sourceMappingURL=files-reference-files.js.map?v=0bf0133e345340325f99