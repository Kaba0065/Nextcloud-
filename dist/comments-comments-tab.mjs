/*! third party licenses: dist/vendor.LICENSE.txt */
import{M as A}from"./chunks/icons-BxSPavMS.mjs";import{aH as c,bO as y}from"./core-common.mjs";import{_ as l}from"./chunks/preload-helper-3Yr03P9X.mjs";import{m as b}from"./chunks/index-j_UZebeA.mjs";import{l as m}from"./chunks/logger-qoNNX8HU.mjs";import{g as O}from"./chunks/GetComments-CkCWKSs2.mjs";import"./chunks/moment-B-oAqI-A.mjs";import"./chunks/moment-B1DRcIE-.mjs";import"./chunks/index-Biv1VH4I.mjs";import"./chunks/headers-Irz06Lip.mjs";import"./chunks/util-Bowr8LpN.mjs";import"./chunks/json2xml-BRHZ5XL4.mjs";let s,a;function _(){window.OCA.Activity.registerSidebarAction({mount:async(e,{context:n,fileInfo:o,reload:i})=>{if(!s){const{default:r}=await l(()=>import("./chunks/ActivityCommentAction-CQ1RBcCC.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url);s=c.extend(r)}a=new s({parent:n,propsData:{reloadCallback:i,resourceId:o.id}}),a.$mount(e),m.info("Comments plugin mounted in Activity sidebar action",{fileInfo:o})},unmount:()=>{a&&a.$destroy()}}),window.OCA.Activity.registerSidebarEntries(async({fileInfo:e,limit:n,offset:o})=>{const{data:i}=await O({resourceType:"files",resourceId:e.id},{limit:n,offset:o});m.debug("Loaded comments",{fileInfo:e,comments:i});const{default:r}=await l(()=>import("./chunks/ActivityCommentEntry-DR9iHSvs.mjs"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url),u=c.extend(r);return i.map(d=>({timestamp:b(d.props.creationDateTime).toDate().getTime(),mount(f,{context:w,reload:C}){this._CommentsViewInstance=new u({parent:w,propsData:{comment:d,resourceId:e.id,reloadCallback:C}}),this._CommentsViewInstance.$mount(f)},unmount(){this._CommentsViewInstance.$destroy()}}))}),window.OCA.Activity.registerSidebarFilter(e=>e.type!=="comments"),m.info("Comments plugin registered for Activity sidebar action")}var p;if(y("comments","activityEnabled",!1)&&((p=OCA==null?void 0:OCA.Activity)==null?void 0:p.registerSidebarAction)!==void 0)window.addEventListener("DOMContentLoaded",function(){_()});else{let e=null;const n=new OCA.Files.Sidebar.Tab({id:"comments",name:t("comments","Comments"),iconSvg:A,async mount(o,i,r){e&&e.$destroy(),e=new OCA.Comments.View("files",{parent:r}),await e.update(i.id),e.$mount(o)},update(o){e.update(o.id)},destroy(){e.$destroy(),e=null},scrollBottomReached(){e.onScrollBottomReached()}});window.addEventListener("DOMContentLoaded",function(){OCA.Files&&OCA.Files.Sidebar&&OCA.Files.Sidebar.registerTab(n)})}
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = [OC.filePath('nextcloud', '', 'dist/chunks/ActivityCommentAction-CQ1RBcCC.mjs'),OC.filePath('nextcloud', '', 'dist/core-common.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/CommentView-iRU-VSYw.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/preload-helper-3Yr03P9X.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/icons-BxSPavMS.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/index-Ca0QcE7e.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/toast-7xJhDYMn-BrG8uCqw.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/GetComments-CkCWKSs2.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/index-Biv1VH4I.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/headers-Irz06Lip.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/util-Bowr8LpN.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/json2xml-BRHZ5XL4.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/logger-qoNNX8HU.mjs'),OC.filePath('nextcloud', '', 'dist/chunks/ActivityCommentEntry-DR9iHSvs.mjs')]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
